<!DOCTYPE html>
<html lang="en" dir="rtl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="KSMoving">
    <meta name="author" content="Coderthemes">

    <link rel="shortcut icon" href="assets/images/favicon_1.ico">

    <title>ניהול ההסעות שלי</title>
    <!--GENERAL object and additional functions-->
    <script src="lib/lz-string.js"></script>
    <script src="lib/master.js"></script>


    <!-- #region REAL-TIME BY SIGNALR - FOR ANY COMPLAINTS WHATSOEVER YOU CAN TALK 2 YOGEV-->
    <script src="../../Scripts/jquery-3.6.0.min.js"></script>
    <script src="../../Scripts/jquery.signalR-2.4.2.min.js"></script>

    <!--Reference↓ the AUTOGENERATED!!! SignalR hub script (by run time)-->
    <script src="../../signalr/hubs"></script>
    <script>

        const notification = $.connection.ridePatHub;
        $.connection.hub.start().done();
        notification.client.driverHasAssigned2RidePat = function (updated_ridePat) {

            /*   *********************
                 * !!! IMPORTANT !!! *
                 ********↓↓↓**********/

            //update the specific ride in arr_rides:
            const index = arr_rides.findIndex(r => r.RidePatNum === updated_ridePat.RidePatNum)
            arr_rides[index] = updated_ridePat;
            /*  *********↑↑↑*********
                * !!! IMPORTANT !!! *
                *********************/
            let ridepat_tr = document.getElementById(updated_ridePat.RidePatNum);
            let table2manipulate = ridepat_tr.closest('table').id
            let thisRidePatDate = new Date(new Date(updated_ridePat.Date) - new Date().getTimezoneOffset() * 60000);
            let thisRidePatLastModified = new Date(new Date(updated_ridePat.LastModified) - new Date().getTimezoneOffset() * 60000);
            let row2manipulate;

            switch (table2manipulate) {

                case 'datatable-morning':

                    row2manipulate = tMorning.row(`#${updated_ridePat.RidePatNum}`).data();

                    row2manipulate.time = thisRidePatDate.getMinutes() === 14 ? 'אחה"צ' : thisRidePatDate.toLocaleTimeString('he-IL', { timeStyle: 'short' });
                    row2manipulate.origin = !isAssistant ? updated_ridePat.Origin.Name : updated_ridePat.Origin.EnglishName;
                    row2manipulate.destination = !isAssistant ? updated_ridePat.Destination.Name : updated_ridePat.Destination.EnglishName;
                    row2manipulate.patient = buildPatientHTML(updated_ridePat);
                    row2manipulate.driver = buildDriverHTML(updated_ridePat.Drivers[0]);
                    row2manipulate.status = buildStatusString(updated_ridePat.Status);
                    row2manipulate.lastModified = thisRidePatLastModified.toLocaleString('he-IL', { dateStyle: "short", timeStyle: "short" });
                    row2manipulate.englishOriginAndDestination = updated_ridePat.Origin.EnglishName + " - " + updated_ridePat.Destination.EnglishName;
                    row2manipulate.remark = updated_ridePat.Remark;

                    tMorning.row(`#${updated_ridePat.RidePatNum}`).data(row2manipulate).draw();
                    break;

                case 'datatable-afternoon':

                    row2manipulate = tAfternoon.row(`#${updated_ridePat.RidePatNum}`).data();

                    row2manipulate.time = thisRidePatDate.getMinutes() === 14 ? 'אחה"צ' : thisRidePatDate.toLocaleTimeString('he-IL', { timeStyle: 'short' });
                    row2manipulate.origin = !isAssistant ? updated_ridePat.Origin.Name : updated_ridePat.Origin.EnglishName;
                    row2manipulate.destination = !isAssistant ? updated_ridePat.Destination.Name : updated_ridePat.Destination.EnglishName;
                    row2manipulate.patient = buildPatientHTML(updated_ridePat);
                    row2manipulate.driver = buildDriverHTML(updated_ridePat.Drivers[0]);
                    row2manipulate.status = buildStatusString(updated_ridePat.Status);
                    row2manipulate.lastModified = thisRidePatLastModified.toLocaleString('he-IL', { dateStyle: "short", timeStyle: "short" });
                    row2manipulate.englishOriginAndDestination = updated_ridePat.Origin.EnglishName + " - " + updated_ridePat.Destination.EnglishName;
                    row2manipulate.remark = updated_ridePat.Remark;

                    tAfternoon.row(`#${updated_ridePat.RidePatNum}`).data(row2manipulate).draw();
                    break;

                case 'datatable-tomorrow':

                    row2manipulate = tTomorrow.row(`#${updated_ridePat.RidePatNum}`).data();

                    row2manipulate.date = thisRidePatDate.toLocaleDateString('he-IL');
                    row2manipulate.time = thisRidePatDate.getMinutes() === 14 ? 'אחה"צ' : thisRidePatDate.toLocaleTimeString('he-IL', { timeStyle: 'short' });
                    row2manipulate.origin = !isAssistant ? updated_ridePat.Origin.Name : updated_ridePat.Origin.EnglishName;
                    row2manipulate.destination = !isAssistant ? updated_ridePat.Destination.Name : updated_ridePat.Destination.EnglishName;
                    row2manipulate.patient = buildPatientHTML(updated_ridePat);
                    row2manipulate.driver = buildDriverHTML(updated_ridePat.Drivers[0]);
                    row2manipulate.status = buildStatusString(updated_ridePat.Status);
                    row2manipulate.lastModified = thisRidePatLastModified.toLocaleString('he-IL', { dateStyle: "short", timeStyle: "short" });
                    row2manipulate.englishOriginAndDestination = updated_ridePat.Origin.EnglishName + " - " + updated_ridePat.Destination.EnglishName;
                    row2manipulate.remark = updated_ridePat.Remark;

                    tTomorrow.row(`#${updated_ridePat.RidePatNum}`).data(row2manipulate).draw();
                    break;

                case 'datatable-future':

                    row2manipulate = tFuture.row(`#${updated_ridePat.RidePatNum}`).data();

                    row2manipulate.date = thisRidePatDate.toLocaleDateString('he-IL');
                    row2manipulate.time = thisRidePatDate.getMinutes() === 14 ? 'אחה"צ' : thisRidePatDate.toLocaleTimeString('he-IL', { timeStyle: 'short' });
                    row2manipulate.origin = !isAssistant ? updated_ridePat.Origin.Name : updated_ridePat.Origin.EnglishName;
                    row2manipulate.destination = !isAssistant ? updated_ridePat.Destination.Name : updated_ridePat.Destination.EnglishName;
                    row2manipulate.patient = buildPatientHTML(updated_ridePat);
                    row2manipulate.driver = buildDriverHTML(updated_ridePat.Drivers[0]);
                    row2manipulate.status = buildStatusString(updated_ridePat.Status);
                    row2manipulate.lastModified = thisRidePatLastModified.toLocaleString('he-IL', { dateStyle: "short", timeStyle: "short" });
                    row2manipulate.englishOriginAndDestination = updated_ridePat.Origin.EnglishName + " - " + updated_ridePat.Destination.EnglishName;
                    row2manipulate.remark = updated_ridePat.Remark;

                    tFuture.row(`#${updated_ridePat.RidePatNum}`).data(row2manipulate).draw();
                    break;

            }


            change_driver_td_Style = ridepat_tr.getElementsByClassName('driver_td')[0].style
            change_driver_td_Style.color = '#797979';



            if (updated_ridePat.Pat.IsAnonymous === 'True') {

                ridepat_tr.style.background = '#FFEF8F';
                change_driver_td_Style.background = '#FFEF8F';
            } else {
                change_driver_td_Style.background = '#f9f9f9'  //only driver td
            }

        }



        /*

case when deleting a driver ...?

3. create amir's UI and update it both new text on the roller and color of lastMODIFIED
         */


        /*

            case of remove a driver
                change content to:
                    driverSpan = 'אין!<br/>None!';
         */


    </script>

    <!-- #endregion REAL-TIME BY SIGNALR - FOR ANY COMPLAINTS WHATSOEVER YOU CAN TALK 2 YOGEV -->
    <!-- DataTables -->
    <link href="../plugins/datatables/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />
    <link href="../plugins/datatables/buttons.bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="../plugins/datatables/fixedHeader.bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="../plugins/datatables/responsive.bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="../plugins/datatables/scroller.bootstrap.min.css" rel="stylesheet" type="text/css" />

    <!-- Sweet Alert css -->
    <link href="../plugins/bootstrap-sweetalert/sweet-alert.css" rel="stylesheet" type="text/css" />

    <link href="../plugins/switchery/switchery.min.css" rel="stylesheet" />
    <link href="assets/css/bootstrap-rtl.min.css" rel="stylesheet" type="text/css">
    <link href="assets/css/core.css" rel="stylesheet" type="text/css">
    <link href="assets/css/icons.css" rel="stylesheet" type="text/css">
    <link href="assets/css/components.css" rel="stylesheet" type="text/css">
    <link href="assets/css/pages.css" rel="stylesheet" type="text/css">
    <link href="assets/css/menu.css" rel="stylesheet" type="text/css">
    <link href="assets/css/responsive.css" rel="stylesheet" type="text/css">

    <script src="assets/js/CookiesFunctions.js"></script>

    <script src="assets/js/modernizr.min.js"></script>



    <script src="assets/js/jquery.min.js"></script>

    <script src="dataTables.js"></script>
    <script src="moment.js"></script>
    <script src="datetime-moment.js"></script>
    <script src="./moment.js"></script>


    <!-- Select2 css+js -->
    <link href="assets/css/select2.css" rel="stylesheet" />
    <script src="assets/js/select2.min.js"></script>
    <!--<script src="lib/moment.js"></script>-->
    <!--<script src="../plugins/moment/moment.js"></script>-->

    <script src="lib/sorting.js"></script>
    <script src="lib/includeHTML.js"></script>



    <script>
        checkCookie();
        var destinationName = "";
        var originName = "";
        var driverName = "";
        var patientName = "";
        var Origin_Dest = "";
        var isAnonymous = false;
        var isAssistant = false;
        var refreshTime;
        var refreshInterval;
        var tomorrowDate = new Date()
        tomorrowDate.setDate(tomorrowDate.getDate() + 1)
        var hospitals = [];
        var returnRidePat;
        var returnRidePatMsg = ""
        var dateReturn;
        var returnDriverMsg;

        let arrayOF_areasObj = [];
        let morningRidePats = [];
        let afterNoonRidePats = [];
        let tomorrowRidePats = [];
        let futureRidePats = [];
        const {

            validateMobileNum,
            addSeperator2MobileNum,
            convertDBDate2FrontEndDate,

        } = GENERAL.USEFULL_FUNCTIONS;

        let tMorning, tAfternoon, tFuture, tTomorrow;


        const showMe = ({ objId, objName }) => {

            const func = 'edit';
            let displayName;
            let arr_details;

            switch (objName) {
                case 'patient':
                    const ridePatWith_ThisPat = arr_rides.find(r => r.Pat.Id === parseInt(objId));
                    displayName = ridePatWith_ThisPat.Pat.DisplayName;
                    arr_details = { displayName, func };
                    GENERAL.PATIENTS.setPatientsList(JSON.stringify(arr_details));
                    break;
                case 'volunteer':
                    const ridePatWith_ThisDriver = arr_rides.find((r) => {

                        if (r.Drivers.length > 0) {
                            return r.Drivers[0].Id === parseInt(objId);
                        }
                    });
                    displayName = ridePatWith_ThisDriver.Drivers[0].DisplayName;
                    arr_details = { displayName, func };
                    GENERAL.VOLUNTEERS.setVolunteersList(JSON.stringify(arr_details));
                    break;
            }

        }


        function wiringDataTables() {
            //manage button clicks on tables


            //#region remove ridepat
            $('#datatable-morning tbody').on('click', '.remove', function () {
                confirmDelete(this, tMorning);
            });

            $('#datatable-afternoon tbody').on('click', '.remove', function () {
                confirmDelete(this, tAfternoon);
            });

            $('#datatable-tomorrow tbody').on('click', '.remove', function () {
                confirmDelete(this, tTomorrow);
            });

            $('#datatable-future tbody').on('click', '.remove', function () {
                confirmDelete(this, tFuture);
            });
            //#endregion

            //#region edit ridepat
            $('#datatable-morning tbody').on('click', '.edit', function () {
                editButton(this);
            });

            $('#datatable-afternoon tbody').on('click', '.edit', function () {
                editButton(this);
            });


            $('#datatable-tomorrow tbody').on('click', '.edit', function () {
                editButton(this);
            });

            $('#datatable-future tbody').on('click', '.edit', function () {
                editButton(this);
            });
            //#endregion




            //#region show target form
            /*
             IMPORTANT NOTE
             the event is mouseup in order to catch all scenarios.

             */
            $('#datatable-morning tbody').on('mouseup', '.showMe', function () {
                let targetObj = {};
                targetObj.objId = $(this).attr('id');
                targetObj.objName = $(this).attr("data-obj");

                showMe(targetObj);

            });

            $('#datatable-afternoon tbody').on('mouseup', '.showMe', function () {
                let targetObj = {};
                targetObj.objId = $(this).attr('id');
                targetObj.objName = $(this).attr("data-obj");

                showMe(targetObj);
            });


            $('#datatable-tomorrow tbody').on('mouseup', '.showMe', function () {
                let targetObj = {};
                targetObj.objId = $(this).attr('id');
                targetObj.objName = $(this).attr("data-obj");

                showMe(targetObj);
            });

            $('#datatable-future tbody').on('mouseup', '.showMe', function () {

                let targetObj = {};
                targetObj.objId = $(this).attr('id');
                targetObj.objName = $(this).attr("data-obj");

                showMe(targetObj);

            });
            //#endregion



            //$('#datatable-morning tbody').on('click', '#candidatesBtn', function () {
            //    candidatesButton(this);
            //});

            //$('#datatable-afternoon tbody').on('click', '#candidatesBtn', function () {
            //    candidatesButton(this);
            //});

            //$('#datatable-future tbody').on('click', '#candidatesBtn', function () {
            //    candidatesButton(this);
            //});

            //$('#datatable-tomorrow tbody').on('click', '#candidatesBtn', function () {
            //    candidatesButton(this);
            //});



        }

        $(document).ready(function () {

            wiringDataTables();
            let { COPYWRITE } = GENERAL;
            $('#rights').html(COPYWRITE());

            if (localStorage.refreshTime == "undefined" || localStorage.refreshTime === undefined) { // Set the deafult refresh rate for 5 minutes
                localStorage.refreshTime = '300000';
                $('#refreshTime').val('300000')
            } else {
                $('#refreshTime').val(parseInt(JSON.parse(localStorage.refreshTime)));
            }
            refreshTime = parseInt(JSON.parse(localStorage.refreshTime));

            $('#refreshTime').on('change', function () {

                localStorage.refreshTime = String(this.value);
                refreshTime = parseInt(JSON.parse(localStorage.refreshTime));
                clearInterval(refreshInterval);
                refreshInterval = setInterval("refreshTable()", refreshTime);

            });

            if (!JSON.parse(localStorage.getItem("isProductionDatabase"))) {
                $("#databaseType").text("Test database ")
            }
            else $("#databaseType").text("Production database")
            $('[data-toggle="tooltip"]').tooltip({
                container: 'body'
            })
            if (window.location.hostname.toString() == 'localhost' || window.location.pathname.toLowerCase().indexOf('test') != -1) {
                $("#na").css("background-color", "#ffde89");
            }
            if (window.location.href.indexOf('http://40.117.122.242/Road%20to%20Recovery/') != -1) {
                window.location.href = "notAvailable.html";
            }
            isAssistant = JSON.parse(GENERAL.USER.getIsAssistant());
            var assistantName = "";
            if (isAssistant) {
                $("#menuType").attr("w3-include-html", "HelperMenu.html");
                var coorAssistant = GENERAL.USER.getCoorAssistant();
                assistantName = GENERAL.USER.getAsistantDisplayName();
            }
            else $("#menuType").attr("w3-include-html", "menu.html");
            includeHTML();
            if (isAssistant) {
                var userName = GENERAL.USER.getAsistantAndCoorDisplayName();
                $("#userName").html(userName);
            }
            else {
                var userName = GENERAL.USER.getUserDisplayName();
                $("#userName").html(userName);
            }


            deceideWhichTable2Show();

            jQuery.extend(jQuery.fn.dataTableExt.oSort, {

                "de_time-asc": function (a, b) {
                    /*a and b are a couple of times hh:mm to compare
                    return value will be:
                    0 if a=b
                    1 if a > b
                   -1 if a < b
                    */

                    let datetime_a = $.trim(a).split(':');
                    let datetime_b = $.trim(b).split(':');

                    let hh_a = parseInt(datetime_a[0]);
                    let mm_a = parseInt(datetime_a[1]);

                    let hh_b = parseInt(datetime_b[0]);
                    let mm_b = parseInt(datetime_b[1]);

                    let now = new Date();

                    let a_dateTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hh_a, mm_a);
                    let b_dateTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hh_b, mm_b);

                    a = a_dateTime.getTime();
                    b = b_dateTime.getTime();

                    if (isNaN(a)) { //this is for אחה"צ
                        a = Infinity;
                    }
                    if (isNaN(b)) {
                        b = Infinity;
                    }

                    return a === b ? 0 : a > b ? 1 : -1;
                },

                "de_time-desc": function (a, b) {
                    /*a and b are a couple of times hh:mm to  compare
                      return value will be:
                      0 if a=b
                     -1 if a > b
                      1 if a < b
                      */
                    let datetime_a = $.trim(a).split(':');
                    let datetime_b = $.trim(b).split(':');

                    let hh_a = parseInt(datetime_a[0]);
                    let mm_a = parseInt(datetime_a[1]);

                    let hh_b = parseInt(datetime_b[0]);
                    let mm_b = parseInt(datetime_b[1]);

                    let now = new Date();

                    let a_dateTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hh_a, mm_a)
                    let b_dateTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hh_b, mm_b)

                    a = a_dateTime.getTime();
                    b = b_dateTime.getTime();

                    if (isNaN(a)) {//this is for אחה"צ
                        a = Infinity;
                    }
                    if (isNaN(b)) {
                        b = Infinity;
                    }

                    return a === b ? 0 : a > b ? -1 : 1;
                },

                "de_date-asc": (a, b) => {

                    /*a and b are a couple of dates to compare
                   return value will be:
                   0 if a=b
                   1 if a > b
                  -1 if a < b
                   */

                    let ddmmyyyArr_a = $.trim(a).split('.');
                    let ddmmyyyArr_b = $.trim(b).split('.');

                    let dd_a = parseInt(ddmmyyyArr_a[0]);
                    let mm_a = parseInt(ddmmyyyArr_a[1]);
                    let yyyy_a = parseInt(ddmmyyyArr_a[2]);

                    let dd_b = parseInt(ddmmyyyArr_b[0]);
                    let mm_b = parseInt(ddmmyyyArr_b[1]);
                    let yyyy_b = parseInt(ddmmyyyArr_b[2]);

                    //let now = new Date();

                    let a_date = new Date(yyyy_a, mm_a + 1, dd_a);
                    let b_date = new Date(yyyy_b, mm_b + 1, dd_b);

                    a = a_date.getTime();
                    b = b_date.getTime();

                    return a === b ? 0 : a > b ? 1 : -1;

                },

                "de_date-desc": (a, b) => {

                    /*a and b are a couple of dates to compare
                   return value will be:
                   0 if a=b
                   1 if a > b
                  -1 if a < b
                   */

                    let ddmmyyyArr_a = $.trim(a).split('.');
                    let ddmmyyyArr_b = $.trim(b).split('.');

                    let dd_a = parseInt(ddmmyyyArr_a[0]);
                    let mm_a = parseInt(ddmmyyyArr_a[1]);
                    let yyyy_a = parseInt(ddmmyyyArr_a[2]);

                    let dd_b = parseInt(ddmmyyyArr_b[0]);
                    let mm_b = parseInt(ddmmyyyArr_b[1]);
                    let yyyy_b = parseInt(ddmmyyyArr_b[2]);

                    //let now = new Date();

                    let a_date = new Date(yyyy_a, mm_a + 1, dd_a);
                    let b_date = new Date(yyyy_b, mm_b + 1, dd_b);

                    a = a_date.getTime();
                    b = b_date.getTime();

                    return a === b ? 0 : a > b ? -1 : 1;
                },

            });

            getCoors();
            refreshTable();

            if (!isAssistant) {

                refreshInterval = setInterval("refreshTable()", refreshTime);
            }

            let allSortsSwitch = JSON.parse(localStorage.getItem('allSortsSwitch'));

            if (allSortsSwitch) {
                $('#allSortsSwitch').prop('checked', true);
                $('#openSortsControllers').prop('disabled', false);
                $('#allSortsLabel').html('כבה סינון');
            } else {
                $('#allSortsSwitch').prop('checked', false);
                $('#openSortsControllers').prop('disabled', true);
                $('#allSortsLabel').html('הפעל סינון');
            }



        });

        const assignTable2lastOne = (tableName) => {

            localStorage.setItem('lastTableWas', tableName);
        }

        const deceideWhichTable2Show = () => {
            /*
             #collapse1 = datatable-morning
             #collapse2 = datatable-afternoon
             #collapse3 = datatable-tomorrow
             #collapse4 = datatable-future
             */

            let table2open = localStorage.getItem('lastTableWas') ? localStorage.getItem('lastTableWas') : '';

            switch (table2open) {

                case 'datatable-morning':
                    $('#collapse1').addClass("in");
                    break;

                case 'datatable-afternoon':
                    $('#collapse2').addClass("in");
                    break;

                case 'datatable-tomorrow':
                    $('#collapse3').addClass("in");
                    break;

                case 'datatable-future':
                    $('#collapse4').addClass("in");
                    break;

                default:
                    setTable2Show_Bytime();
                    break;

            }

        }

        const setTable2Show_Bytime = () => {

            let now = new Date();

            if (parseInt(now.getHours()) <= 12) {//show the morning table

                $('#collapse1').addClass("in");
            } else {//show the afternoon table

                $('#collapse2').addClass("in");
            }


        }

        function getCoors() {
            $.ajax({
                dataType: "json",
                url: "WebService.asmx/getCoorList",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                async: false,
                //data: JSON.stringify({}),
                success: getCoorsSuccessCB,
                error: getCoorsErrorCB
            });
        }

        function sendMessegeFromAssistant(ridepat, cellphone, msg) {
            $.ajax({
                dataType: "json",
                url: "WebService.asmx/pushAssistant",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                async: false,
                data: JSON.stringify({ ridepat: ridepat, cellphone: cellphone, msg: msg }),
                error: pushAssistantErrorCB
            });
        }

        function pushAssistantErrorCB(error) {
            console.log(error);
        }

        function getCoorsSuccessCB(data) {
            var arr_coor = JSON.parse(data.d);
            var user = GENERAL.USER.getUserName();
            for (i in arr_coor) {
                if (user == arr_coor[i].UserName) {
                    currentCoor = arr_coor[i].DisplayName;
                    GENERAL.USER.setUserType(arr_coor[i].TypeVol)
                    break;
                }
            }
        }

        function getCoorsErrorCB(e) {
            alert("Error in getCoors: " + e.responseText);
        }


        function confirmDelete(deleteBtn, table) {

            let ridePatNum = parseInt(deleteBtn.id);

            //IMMUTABLE paradigme !
            const original_deleteCandidate = arr_rides.find((r) => r.RidePatNum === ridePatNum);


            let deleteCandidate = {
                ...original_deleteCandidate,
                Date: convertDBDate2FrontEndDate(original_deleteCandidate.Date)
            }


            let isAfterNoon = deleteCandidate.Date.getMinutes() === 14;
            let isToday = table.context[0].sTableId === "datatable-afternoon" || table.context[0].sTableId === "datatable-morning";

            const { DisplayName } = deleteCandidate.Pat;
            const { Name: from } = deleteCandidate.Origin;
            const { Name: to } = deleteCandidate.Destination;
            const { Date: date } = deleteCandidate; //Date is a reserved word for js! DO NOT ASSIGHN !!!

            let msg2user = `מחיקת ההסעה של ${DisplayName} מ: ${from} ל: ${to} `;

            msg2user += isToday ? 'היום ' :
                `יציאה בתאריך ${date.toLocaleString('he-IL', { dateStyle: 'short' })} `;

            msg2user += isAfterNoon ? 'בשעות אחה"צ ' :
                `בשעה ${date.toLocaleString('he-IL', { timeStyle: 'short' })} `;

            swal({
                title: "هل انت متأكد?\nהאם אתם בטוחים?",
                type: "warning",
                text: msg2user,
                showCancelButton: true,
                cancelButtonText: "الغاء\nבטל",
                confirmButtonClass: 'btn-warning',
                confirmButtonText: "حذف\nמחיקה",
                closeOnConfirm: true
            }, function (userResponse) {
                if (userResponse) {
                    deleteRidePat(original_deleteCandidate, deleteBtn, table);
                }

            });


        }

        //const candidatesButton = (btn) => {
        //    let ridePatNum = btn.id;
        //    GENERAL.RIDEPAT.setRidePatNum4_viewCandidate(ridePatNum);
        //    location.href = "viewCandidates.html";
        //}

        //function showButton(ridePat) {
        //    arr_details = { RidePatNum: ridePat.name, func: "show" };//ridePat.name=RidePatNum
        //    GENERAL.RIDEPAT.setRidePatList(JSON.stringify(arr_details));
        //    location.href = "ridePatForm.html";
        //}

        function editButton(ridePat) {
            arr_details = { RidePatNum: ridePat.name, func: "edit" }; //ridePat.name=RidePatNum
            GENERAL.RIDEPAT.setRidePatList(JSON.stringify(arr_details));
            location.href = "ridePatForm.html";
        }

        //function backupToPrimaryButton(ridePat) {
        //    //arr_details = { RidePatNum: ridePat.name, func: "show" };//ridePat.name=RidePatNum
        //    var RidePat = new Object();
        //    RidePat.RidePatNum = ridePat.name;

        //    $.ajax({
        //        dataType: "json",
        //        url: "WebService.asmx/backupToPrimaryNotification",
        //        contentType: "application/json; charset=utf-8",
        //        type: "POST",
        //        data: JSON.stringify({ ridePatId: RidePat.RidePatNum }),
        //        success: function (data) {
        //            if (data.d == 1) {
        //                swal({
        //                    title: "لقد تم ارسال الرسالة\nההודעה נשלחה",
        //                    timer: 1000,
        //                    type: "success",
        //                    showConfirmButton: false
        //                });
        //            }


        //        },
        //        error: function (err) {
        //            alert("Error in backupToPrimaryNotification:" + err.responseText);
        //        }
        //    });
        //}

        function deleteRidePat(ridePat, deleteBtn, thistable) {
            checkCookie();
            $('#wait').show();
            // var numberOfRides = 1;
            //var repeatRide = "";
            let ridePatNums2MarkDeleted = [];
            ridePatNums2MarkDeleted.push(ridePat.RidePatNum);
            let nowInUTC = new Date().toUTCString();

            $.ajax({
                dataType: "json",
                url: "WebService.asmx/ChangeArrayOF_RidePatStatuses",
                contentType: "application/json; charset=utf-8",
                type: "POST",
                data: JSON.stringify({ newStatus: 'נמחקה', ridePatNums: ridePatNums2MarkDeleted, clientUTCTimeStemp: nowInUTC }),
                success: function () {
                    swal({
                        title: "لقد تم حذف السفرية\nההסעה נמחקה",
                        timer: 1000,
                        type: "success",
                        showConfirmButton: false
                    });


                    if (thistable && deleteBtn) {
                        thistable.row($(deleteBtn).parents('tr')).remove().draw();
                    } else {
                        location.reload();
                    }

                    let RidePat = {
                        Date: typeof ridePat.Date === 'string' ? convertDBDate2FrontEndDate(ridePat.Date) : ridePat.Date,
                        Destination: ridePat.Destination,
                        Origin: ridePat.Origin,
                        Pat: ridePat.Pat
                    }

                    $.ajax({
                        dataType: "json",
                        url: "WebService.asmx/getReturnRidePat",
                        contentType: "application/json; charset=utf-8",
                        type: "POST",
                        async: false,
                        data: JSON.stringify({ RidePat }),
                        success: function (data) {

                            returnRidePat = JSON.parse(data.d);


                            if (returnRidePat && returnRidePat.Status !== 'נמחקה') {
                                $('#wait').hide();

                                let patientName = 'חולה';
                                if (!returnRidePat.Pat.DisplayName.includes("אנונימי")) {
                                    patientName = returnRidePat.Pat.DisplayName;
                                }
                                let frontEndDate = convertDBDate2FrontEndDate(returnRidePat.Date);

                                if (frontEndDate.getMinutes() === 14) {//afternoon
                                    frontEndDate = `תאריך ${frontEndDate.toLocaleDateString('he-IL')} בשעות אחה"צ`;
                                } else {
                                    frontEndDate = frontEndDate.toLocaleString('he-IL', { dateStyle: 'short', timeStyle: 'short' });
                                }

                                returnRidePatMsg = `האם למחוק גם את ההחזרה של ${patientName} מ${returnRidePat.Origin.Name} ל${returnRidePat.Destination.Name} ב${frontEndDate}`;
                                $('#DriverReturnRidePatMsg').html("");
                                if (returnRidePat.Drivers.length != 0) {
                                    returnDriverMsg = returnRidePat.Drivers[0].DisplayName + " נרשם להחזרה הזו!";
                                    $('#DriverReturnRidePatMsg').html("<h5 style='color:red; font-weight: bold;'>שימו לב!</h5><h5>" + returnRidePat.Drivers[0].DisplayName + " נרשם להחזרה הזו!</h5>");
                                }

                                $('#returnRidePatMsg').html(returnRidePatMsg);
                                $('#messagesModal').modal('toggle');
                            } else {
                                $('#wait').hide();
                            }
                        },
                        error: function (err) {
                            alert("Error in getReturnRidePat: " + err.responseText);
                            console.log(err);
                        }
                    })
                },
                error: function (err) { alert("Error in deleteRidePat:" + err.responseText); }
            });

        }

        function newRidePatForm() {
            ridePatNum = " ";
            arr_details = { ridePatNum: ridePatNum, func: "new" };
            GENERAL.RIDEPAT.setRidePatList(JSON.stringify(arr_details));
            location.href = "ridePatForm.html";
        }

        function deleteReturn() {

            var RidePat = new Object();
            RidePat.RidePatNum = returnRidePat.RidePatNum;
            //   var tempDate = dateReturn; --wtf ?! YOGEV disable it
            var tempDate = "01/01/1970"; // Fictional date for deletion
            var tempDateReveresed = tempDate.split('/').reverse().join('/')
            var date3 = new Date(tempDateReveresed);
            RidePat.Date = date3;
            if (isNaN(date3.getTime())) {
                var date3 = new Date();
                var tempHour = tempDate.split(':');
                date3.setHours(tempHour[0])
                RidePat.Date = date3;
            }
            var Pat = new Object();
            Pat.DisplayName = returnRidePat.Pat.DisplayName;
            RidePat.Pat = Pat;
            var Destination = new Object();
            Destination.Name = returnRidePat.Destination.Name;
            RidePat.Destination = Destination;
            var Origin = new Object();
            Origin.Name = returnRidePat.Origin.Name;
            RidePat.Origin = Origin;

            let thisTable = null;
            let deleteBtn = null;

            if (document.getElementById(`${RidePat.RidePatNum}`) !== null) { //DUE TO SORTING THE ROW IS NOT RENDERED


                deleteBtn = document.getElementById(`${RidePat.RidePatNum}`);

                switch ($(deleteBtn).parents("table:first")[0].id) {
                    case 'datatable-morning':
                        thisTable = tMorning;
                        break;
                    case 'datatable-afternoon':
                        thisTable = tAfternoon;
                        break;
                    case 'datatable-tomorrow':
                        thisTable = tTomorrow
                        break;
                    case 'datatable-future':
                        thisTable = tFuture;
                        break;
                }

            }

            returnRidePat = null;
            $('#messagesModal').modal('toggle');
            $('#DriverReturnRidePatMsg').html("");
            deleteRidePat(RidePat, deleteBtn, thisTable);
        }

        function closeModal() {
            $('#messagesModal').modal('hide');
            $('#DriverReturnRidePatMsg').html("");

            //הסטטוס 'אין נסיעת הלוך' עושה בעיות כיוון שלא ניתן להשתבץ אליו.
            //newStatus = "אין נסיעת הלוך"


        }

        const showFiltersModal = () => {

            let { ajaxCall } = GENERAL.FETCH_DATA;

            ajaxCall(
                'getAreas_AsLocationObj',
                '',
                getAreas_SCB,
                getAreas_ECB
            );

            $('#filtersModal').modal({
                backdrop: 'static', //prevent popup to close when clicking outside
                keyboard: false     //prevent popup to close when press esc on the keyboard
            })
            $('#filtersModal').modal('show');
        }

        const getAreas_ECB = (err) => { console.log(err); }

        const getAreas_SCB = (data) => {

            let listOfAreas = JSON.parse(data.d);

            let checkBoxesStr = '';

            const arrayOF_areasObj_isEmpty = localStorage.getItem('arrayOF_areasObj') === null || localStorage.getItem('arrayOF_areasObj') === 'null';

            let areasFromLs = JSON.parse(localStorage.getItem('arrayOF_areasObj'));


            if (!arrayOF_areasObj_isEmpty && listOfAreas.length > areasFromLs.length) {
                //case when 1 or more new areas added and ls is allready exist

                for (let i = areasFromLs.length; i < listOfAreas.length; i++) { //the gap between them
                    areasFromLs.push({
                        hebrewName: listOfAreas[i].Area,
                        englishName: listOfAreas[i].EnglishName,
                        checked: false
                    });
                }
                localStorage.setItem('arrayOF_areasObj', JSON.stringify(areasFromLs));
            } else if (!arrayOF_areasObj_isEmpty && listOfAreas.length < areasFromLs.length) {
                localStorage.setItem('arrayOF_areasObj', null);
                location.reload();
            }

            for (let i = 0; i < listOfAreas.length; i++) {

                if (arrayOF_areasObj_isEmpty) {

                    arrayOF_areasObj[i] = { hebrewName: listOfAreas[i].Area, englishName: listOfAreas[i].EnglishName }

                    if (i === listOfAreas.length - 1) {
                        localStorage.setItem('arrayOF_areasObj', JSON.stringify(arrayOF_areasObj));
                    }
                }

                checkBoxesStr += `<div>`;
                checkBoxesStr += `<input type="checkbox" id="${listOfAreas[i].EnglishName}" checked />`;
                checkBoxesStr += `<label class="overRideBS_label" for="${listOfAreas[i].EnglishName}">&nbsp;${listOfAreas[i].Area}</label>`;
                checkBoxesStr += `</div>`;
            }
            document.getElementById('filtersModal_placeHolder').innerHTML = checkBoxesStr;

            if (!arrayOF_areasObj_isEmpty) {

                let checkBoxesContainer = document.getElementById('filtersModal_placeHolder').children;
                let arrayOF_areasObj = JSON.parse(localStorage.getItem('arrayOF_areasObj'));

                for (let i = 0; i < checkBoxesContainer.length; i++) {
                    $(`#${arrayOF_areasObj[i].englishName}`).prop('checked', arrayOF_areasObj[i].checked);
                }

            }
        }

        const saveFilters = () => {

            let checkBoxesContainer = document.getElementById('filtersModal_placeHolder').children;
            let arrayOF_areasObj = JSON.parse(localStorage.getItem('arrayOF_areasObj'));

            let areasToShow_arr = [];

            for (let i = 0; i < checkBoxesContainer.length; i++) {
                arrayOF_areasObj[i] = {
                    ...arrayOF_areasObj[i],
                    checked: $(`#${arrayOF_areasObj[i].englishName}`).prop('checked')
                };

                if ($(`#${arrayOF_areasObj[i].englishName}`).prop('checked')) {
                    areasToShow_arr.push(arrayOF_areasObj[i].hebrewName);
                }
            }

            localStorage.setItem('arrayOF_areasObj', JSON.stringify(arrayOF_areasObj));
            localStorage.setItem('areasToShow_arr', JSON.stringify(areasToShow_arr));

            refreshTable();
        }

        const allSortsSwitch_changed = () => {

            let considerSorts_controllers = $('#allSortsSwitch').prop('checked');
            localStorage.setItem('allSortsSwitch', JSON.stringify(considerSorts_controllers));

            if (!considerSorts_controllers) {

                $('#allSortsLabel').html('הפעל סינון');
                $('#openSortsControllers').prop('disabled', true);
                refreshTable();
            } else {

                $('#allSortsLabel').html('כבה סינון');
                $('#openSortsControllers').prop('disabled', false);
                refreshTable();
            }

        }

        function refreshTable() {
            $('#wait').show();

            morningRidePats = [];
            afterNoonRidePats = [];
            tomorrowRidePats = [];
            futureRidePats = [];

            let areasToShow_arr = JSON.parse(localStorage.getItem('areasToShow_arr'));
            let allSortsSwitch = JSON.parse(localStorage.getItem('allSortsSwitch'));

            checkCookie();

            if (areasToShow_arr !== null && areasToShow_arr.length === 0 && allSortsSwitch) { //dont show any
                $('#wait').hide();

                tMorning = $('#datatable-morning').DataTable({ data: [], destroy: true });

                tAfternoon = $('#datatable-afternoon').DataTable({ data: [], destroy: true });

                tTomorrow = $('#datatable-tomorrow').DataTable({ data: [], destroy: true });

                tFuture = $('#datatable-future').DataTable({ data: [], destroy: true });
                return;
            }

            var volunteerId = -1 // VolunteerId - 1 means get ALL FUTURE ridePats // VolunteerId -2 means get ALL ridePats

            $.ajax({
                dataType: "json",
                url: "WebService.asmx/GetRidePatView",
                contentType: "application/json; charset=utf-8",
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("Content-Encoding", "gzip");
                },
                type: "POST",
                data: JSON.stringify({ volunteerId: volunteerId, maxDays: 30 }),
                success: function (data) {
                    $('#wait').hide();
                    arr_rides = JSON.parse(data.d);

                    GENERAL.RIDEPAT.setRidePatList(JSON.stringify(arr_rides));

                    let thisRidePatDate;
                    let thisRidePat = {};
                    let editBtn;
                    let deleteBtn;
                    let btnStr = '';
                    let lastModified = convertDBDate2FrontEndDate(arr_rides[i].LastModified).toLocaleString('he-IL', { dateStyle: "short", timeStyle: "short" });
                    let numOfRealEscorts = 0; //not anonymous
                    let driverColumnContent = '';
                    let englishStatus = '';
                    let patientHTML;
                    let driverHTML;
                    let status2render;


                    for (let i = 0; i < arr_rides.length; i++) {

                        if (allSortsSwitch && areasToShow_arr !== null) {
                            if (areasToShow_arr.length !== 0) {
                                if (!areasToShow_arr.includes(arr_rides[i].Area)) {
                                    continue;
                                }
                            }
                        }

                        thisRidePatDate = convertDBDate2FrontEndDate(arr_rides[i].Date);
                        numOfEscorts = arr_rides[i].Escorts.length;

                        //#region adjust patient column
                        patientHTML = buildPatientHTML(arr_rides[i]);

                        //#endregion

                        //#region adjust driver column
                        driverHTML = '';

                        if (arr_rides[i].Drivers.length > 0) {

                            driverHTML = buildDriverHTML(arr_rides[i].Drivers[0]);;
                        } else {

                            driverHTML = 'אין!<br/>None!';
                        }
                        //#endregion adjust driver column

                        //#region Status

                        status2render = buildStatusString(arr_rides[i].Status);

                        //#endregion Status

                        //#region buttons
                        editBtn = `<button type='button' class='edit btn btn-icon waves-effect waves-light btn-primary btn-sm m-r-5 m-b-5' id='${arr_rides[i].RidePatNum}' name='${arr_rides[i].RidePatNum}' title='עריכה'><i class='ti-pencil'></i></button>`;
                        deleteBtn = `<button type='button' class='remove btn btn-icon waves-effect waves-light btn-danger btn-sm m-b-5'id='${arr_rides[i].RidePatNum}' name='${arr_rides[i].RidePatNum}' title='מחיקה'><i class='fa fa-remove'></i></button>`;
                        btnStr = `<div class='btnsInSameLine'>${editBtn} ${deleteBtn}</div>`;
                        //#endregion buttons

                        thisRidePat = {
                            ridePatNum: arr_rides[i].RidePatNum,
                            time: thisRidePatDate.getMinutes() === 14 ? 'אחה"צ' : thisRidePatDate.toLocaleTimeString('he-IL', { timeStyle: 'short' }),
                            origin: isAssistant ? arr_rides[i].Origin.EnglishName : arr_rides[i].Origin.Name,
                            destination: isAssistant ? arr_rides[i].Destination.EnglishName : arr_rides[i].Destination.Name,
                            patient: patientHTML,
                            driver: driverHTML,
                            status: status2render,
                            lastModified: convertDBDate2FrontEndDate(arr_rides[i].LastModified).toLocaleString('he-IL', { dateStyle: "short", timeStyle: "short" }),
                            englishOriginAndDestination: arr_rides[i].Origin.EnglishName + " - " + arr_rides[i].Destination.EnglishName,
                            remark: arr_rides[i].Remark,
                            isAnonymous: arr_rides[i].Pat.IsAnonymous === 'True',
                            buttons: btnStr,
                        }

                        if (thisRidePatDate.toLocaleDateString() === new Date().toLocaleDateString()) {                  //<---- today
                            if (thisRidePatDate.getHours() < 12) {                                                              //<---- today morning

                                morningRidePats.push(thisRidePat);
                            } else {                                                                                          //<---- today afternoon

                                afterNoonRidePats.push(thisRidePat);
                            }

                        } else if (thisRidePatDate.toLocaleDateString() === tomorrowDate.toLocaleDateString()) {        //<---- tomorrow

                            thisRidePat.date = thisRidePatDate.toLocaleString('he-IL', { dateStyle: 'short' });
                            tomorrowRidePats.push(thisRidePat);
                        } else if (thisRidePatDate > tomorrowDate) {                                                     //<---- future

                            thisRidePat.date = thisRidePatDate.toLocaleString('he-IL', { dateStyle: 'short' });
                            futureRidePats.push(thisRidePat);
                        }




                    }



                    //           ============================
                    //           || ↓DATATABLES PROPERTIES↓||
                    //           ============================

                    tMorning = $('#datatable-morning').DataTable({
                        data: morningRidePats,
                        rowId: 'ridePatNum',
                        pageLength: 100,
                        stateSave: true,
                        destroy: true,
                        columns: [
                            //when add column be aware of columnDefs refernces [i] IMPORTANT !!!
                            { data: "time" },                                //0
                            { data: "origin" },                              //1
                            { data: "destination" },                         //2
                            { data: "patient" },                             //3
                            { data: "driver" },                              //4
                            { data: "status" },                              //5
                            { data: "lastModified" },                        //6
                            { data: "englishOriginAndDestination" },         //7
                            { data: "remark" },                              //8
                            { data: "isAnonymous" },                         //9
                            { data: "buttons" },                             //10
                        ],
                        columnDefs: [

                            { targets: 0, type: 'de_time' },
                            {
                                targets: [1, 2, 3, 4, 5], createdCell: (cell, cellData, rowData, rowIndex, colIndex) => {
                                    if (isAssistant) {
                                        cell.className += ' ltr';
                                    }

                                    switch (colIndex) {
                                        case 4: //driver column
                                            cell.className += ' driver_td';
                                            if (cellData.indexOf('אין!') !== -1) {
                                                cell.style.backgroundColor = "red";
                                                cell.style.color = "white";
                                                cell.style.fontWeight = "bold";
                                            }
                                            break;

                                        case 5://status column
                                            if (
                                                cellData.indexOf("הגענו ליעד") !== -1 ||
                                                cellData.indexOf("Reached destination") !== -1
                                            ) {
                                                cell.style.backgroundColor = "green";
                                                cell.style.color = "white";
                                            }
                                            else if (cellData.includes('שובץ נהג') || cellData.includes('Driver registered')) {

                                                if (rowData["isAnonymous"]) {

                                                    //in other words, if there is a driver on a ride with anonymous patient
                                                    cell.parentElement.style.background = '#FFEF8F';
                                                }
                                            }
                                            break;

                                    }

                                }
                            },

                            { targets: 7, className: 'text-left-strong' },
                            { "targets": [9], visible: false },


                        ],


                    });

                    tAfternoon = $('#datatable-afternoon').DataTable({
                        rowId: 'ridePatNum',
                        pageLength: 100,
                        data: afterNoonRidePats,
                        stateSave: true,
                        destroy: true,
                        columns: [
                            //when add column be aware of columnDefs refernces [i] IMPORTANT !!!
                            { data: "time" },                                //0
                            { data: "origin" },                              //1
                            { data: "destination" },                         //2
                            { data: "patient" },                             //3
                            { data: "driver" },                              //4
                            { data: "status" },                              //5
                            { data: "lastModified" },                        //6
                            { data: "englishOriginAndDestination" },         //7
                            { data: "remark" },                              //8
                            { data: "isAnonymous" },                         //9
                            { data: "buttons" },                             //10
                        ],
                        columnDefs: [
                            { targets: 0, type: 'de_time' },
                            { targets: [0], createdCell: (td) => { $(td).attr('id', 'rideTiming') } },
                            {
                                targets: [1, 2, 3, 4, 5], createdCell: (cell, cellData, rowData, rowIndex, colIndex) => {
                                    if (isAssistant) {
                                        cell.className += ' ltr';
                                    }

                                    switch (colIndex) {

                                        case 1: //origin
                                            $(cell).attr('id', 'OriginName');
                                            if (cellData.indexOf('מרכז') !== -1
                                                || cellData.indexOf('center') !== -1
                                                || rowData['destination'].indexOf('מרכז') !== -1
                                                || rowData['destination'].indexOf('center') !== -1
                                            ) {
                                                cell.parentElement.style.background = '#FFEF8F';
                                            }
                                            break;

                                        case 2://destination
                                            createdCell: (td) => { $(td).attr('id', 'DestinationName') }
                                            break;

                                        case 4: //driver
                                            //this code is identical to the one in datatable-tomorrow when can need to change to 1 function
                                            cell.className += ' driver_td';
                                            if (cellData.indexOf('אין!') !== -1) {

                                                let now = new Date();
                                                let ridePatTime_td;
                                                if (rowData['time'] === 'אחה"צ') {

                                                    ridePatTime_td = [12, 0];
                                                } else {

                                                    ridePatTime_td = $.trim(rowData['time']).split(':');
                                                }


                                                let ridePatTimeObj = {
                                                    hh: parseInt(ridePatTime_td[0]),
                                                    mm: parseInt(ridePatTime_td[1])
                                                }
                                                let ridePatTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), ridePatTimeObj.hh, ridePatTimeObj.mm);

                                                let miliSeconds_gap = ridePatTime - now;
                                                let hours_gap = miliSeconds_gap / (1000 * 60 * 60); //1000 ms in 1 sec, 60 sec in 1m, 60 min in 1h

                                                if (hours_gap >= 0) {
                                                    cell.style.color = "white";
                                                    cell.style.fontWeight = "bold";
                                                    if (hours_gap <= 12) {
                                                        cell.style.backgroundColor = "red";
                                                    } else if (hours_gap <= 24) {
                                                        cell.style.backgroundColor = "orange";
                                                    }
                                                }
                                            }
                                            break;

                                        case 5://status
                                            if (cellData.indexOf("הגענו ליעד") !== -1 ||
                                                cellData.indexOf("Reached destination") !== -1) {

                                                cell.style.backgroundColor = "green";
                                                cell.style.color = "white";
                                            } else if (cellData.includes('שובץ נהג') || cellData.includes('Driver registered')) {

                                                if (rowData["isAnonymous"]) {
                                                    //in other words, if there is a driver on a ride with anonymous patient
                                                    cell.parentElement.style.background = '#FFEF8F';
                                                }
                                            }
                                            break;
                                    }

                                }
                            },

                            { targets: 7, className: 'text-left-strong' },
                            { targets: [9], visible: false },

                        ]

                    },

                    );

                    tTomorrow = $('#datatable-tomorrow').DataTable({
                        rowId: 'ridePatNum',
                        data: tomorrowRidePats,
                        stateSave: true,
                        destroy: true,
                        "pageLength": 100,
                        columns: [
                            //when add column be aware of columnDefs refernces [i] IMPORTANT !!!
                            { data: "date" },                                //0
                            { data: "time" },                                //1
                            { data: "origin" },                              //2
                            { data: "destination" },                         //3
                            { data: "patient" },                             //4
                            { data: "driver" },                              //5
                            { data: "status" },                              //6
                            { data: "lastModified" },                        //7
                            { data: "englishOriginAndDestination" },         //8
                            { data: "remark" },                              //9
                            { data: "isAnonymous" },                         //10
                            { data: "buttons" },                             //11
                        ],
                        "columnDefs": [
                            { targets: 1, type: 'de_time' },
                            {
                                targets: 5, createdCell: (cell, cellData, rowData, rowIndex, colIndex) => { //5 is driver column

                                    cell.className += ' driver_td';
                                    if (cellData.indexOf('אין!') !== -1) {

                                        //this code is identical to the one in datatable-afternoon when can need to change to 1 function
                                        let now = new Date();
                                        let ridePatTime_td;
                                        if (rowData['time'] === 'אחה"צ') {

                                            ridePatTime_td = [12, 0];
                                        } else {

                                            ridePatTime_td = $.trim(rowData['time']).split(':');
                                        }

                                        let ridePatTimeObj = {
                                            hh: parseInt(ridePatTime_td[0]),
                                            mm: parseInt(ridePatTime_td[1])
                                        }
                                        let ridePatTime = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, ridePatTimeObj.hh, ridePatTimeObj.mm);

                                        let miliSeconds_gap = ridePatTime - now;
                                        let hours_gap = miliSeconds_gap / (1000 * 60 * 60); //1000 ms in 1 sec, 60 sec in 1m, 60 min in 1h

                                        if (hours_gap >= 0) {
                                            if (hours_gap <= 12) {
                                                cell.style.color = "white";
                                                cell.style.fontWeight = "bold";
                                                cell.style.backgroundColor = "red";
                                            } else if (hours_gap <= 24) {
                                                cell.style.color = "white";
                                                cell.style.fontWeight = "bold";
                                                cell.style.backgroundColor = "orange";
                                            }
                                        }


                                    }
                                }
                            },
                            {
                                targets: 6, createdCell: (cell, cellData, rowData, rowIndex, colIndex) => { //6 is status column
                                    if (cellData.indexOf("הגענו ליעד") !== -1 ||
                                        cellData.indexOf("Reached destination") !== -1) {

                                        cell.style.backgroundColor = "green";
                                        cell.style.color = "white";
                                    } else if (cellData.includes('שובץ נהג') || cellData.includes('Driver registered')) {

                                        if (rowData["isAnonymous"]) {
                                            //in other words, if there is a driver on a ride with anonymous patient
                                            cell.parentElement.style.background = '#FFEF8F';
                                        }
                                    }
                                }
                            },
                            { targets: 8, className: 'text-left-strong' },
                            { targets: [10], visible: false },

                        ],
                    });

                    tFuture = $('#datatable-future').DataTable({
                        rowId: 'ridePatNum',
                        data: futureRidePats,
                        stateSave: true,
                        destroy: true,
                        columns: [
                            //when add column be aware of columnDefs refernces [i] IMPORTANT !!!
                            { data: "date" },                                //0
                            { data: "time" },                                //1
                            { data: "origin" },                              //2
                            { data: "destination" },                         //3
                            { data: "patient" },                             //4
                            { data: "driver" },                              //5
                            { data: "status" },                              //6
                            { data: "lastModified" },                        //7
                            { data: "englishOriginAndDestination" },         //8
                            { data: "remark" },                              //9
                            { data: "isAnonymous" },                         //10
                            { data: "buttons" },                             //11
                        ],
                        "pageLength": 100,
                        "columnDefs": [
                            { targets: 0, type: 'de_date' },
                            { targets: 1, type: 'de_time' },
                            { targets: 5, className: 'driver_td' },
                            { targets: 8, className: 'text-left-strong' },
                            { targets: [10], visible: false },
                        ],
                    },
                    );

                    //            ============================
                    //            || ↑DATATABLES PROPERTIES↑||
                    //            ============================


                    $(".dataTables_empty").html("אין הסעות لا توجد سفريات No drives");

                },
                error: function (err) {
                    $('#wait').hide();
                    alert("Error in GetRidePatView: " + err.responseText);
                }
            });
        }


        const buildDriverHTML = (driver) => {

            let driverInnerContent = '';
            let driverWrapper = '';
            const { Id, DisplayName, EnglishFN, EnglishLN, CellPhone } = driver;

            if (!isAssistant) {                         //hebrew

                driverInnerContent = DisplayName;
            } else {                                    //english

                driverInnerContent = EnglishFN.length + EnglishLN.length > 0 ?
                    `${EnglishFN} ${EnglishLN}`
                    :
                    DisplayName
            }

            driverWrapper = `<a href="volunteerform.html" data-obj="volunteer" class="showMe driverName clickable blueFont boldFont"`;
            driverWrapper += `id='${Id}'>${driverInnerContent}</a>`;
            driverWrapper += `<span class="driverCellPhone">${addSeperator2MobileNum(CellPhone, '-')}</span>`;

            return driverWrapper;
        }

        const buildPatientHTML = (ridepat) => {
            let patientPhone2render = "";
            let numOfEscorts = ridepat.Escorts.length;
            let numOfPassengers = '<span class="numOfPassengers">נוסע יחיד</span>';
            let numOfPassengers_English =
                '<span class="numOfPassengers">single passenger</span>';
            let escortsPhone2render = "";
            let equipmentsAndnumOfPassengers = "";

            if (validateMobileNum(ridepat.Pat.CellPhone)) {
                patientPhone2render = `<span class="patientPhone2render">${addSeperator2MobileNum(
                    ridepat.Pat.CellPhone,
                    "-"
                )}</span>`;
            }

            if (numOfEscorts > 0) {
                numOfPassengers = `<span class="numOfPassengers">${numOfEscorts + 1
                    } נוסעים</span>`;
                numOfPassengers_English = `<span class="numOfPassengers">${numOfEscorts + 1
                    } passengers</span>`;
                let numOfValidsPhones4Escorts = ridepat.Escorts.filter((es) =>
                    validateMobileNum(es.CellPhone)
                ).length;

                escortsPhone2render = '<span class="escortsPhone2render block">מלווים: ';
                numOfRealEscorts = 0;

                ridepat.Escorts.map((es, i) => {
                    if (validateMobileNum(es.CellPhone)) {
                        if (!es.IsAnonymous) {
                            numOfRealEscorts++;
                            escortsPhone2render += `${addSeperator2MobileNum(
                                es.CellPhone,
                                "-"
                            )}, `;

                            if (i === numOfEscorts - 1) {
                                escortsPhone2render = escortsPhone2render.substring(
                                    0,
                                    escortsPhone2render.length - 2
                                );
                                escortsPhone2render += "</span>";
                            }
                        }
                    }
                });
                if (numOfRealEscorts === 0) escortsPhone2render = "";
            } else {
                numOfPassengers = `<span class="numOfPassengers">נוסע יחיד</span>`;
                numOfPassengers_English = `<span class="numOfPassengers">single pasnger</span>`;
            }

            if (ridepat.Pat.Equipment.length > 0) {
                equipmentsAndnumOfPassengers = `<div class="equipmentsAndnumOfPassengers">`;
                equipmentsAndnumOfPassengers += isAssistant
                    ? numOfPassengers_English
                    : numOfPassengers;
                equipmentsAndnumOfPassengers += `<div>`;
                ridepat.Pat.Equipment.map((eq) => {
                    equipmentsAndnumOfPassengers += `<img class="equipments-img" src="../../Media/${eq}.png" />`;
                });
                equipmentsAndnumOfPassengers += `</div>`;
                equipmentsAndnumOfPassengers += `</div>`;
            } else {
                equipmentsAndnumOfPassengers = `<div class="equipmentsAndnumOfPassengers block">`;
                equipmentsAndnumOfPassengers += isAssistant
                    ? numOfPassengers_English
                    : numOfPassengers;
                equipmentsAndnumOfPassengers += `</div>`;
            }

            let patientAddons =
                equipmentsAndnumOfPassengers + patientPhone2render + escortsPhone2render;
            let patientName2render = "";
            let patient_English_Name2render = "";

            if (ridepat.Pat.DisplayName.includes("אנונימי")) {
                patientName2render = "<span class='boldFont'>חולה</span>";
                patient_English_Name2render = "<span class='boldFont'>patient</span>";
            } else {
                patientName2render = `<a href="patientform.html" data-obj="patient" class='showMe blueFont clickable boldFont' id='${ridepat.Pat.Id}'>${ridepat.Pat.DisplayName}</a>`;
                patient_English_Name2render = `<a href="patientform.html" data-obj="patient" class='showMe blueFont clickable boldFont' id='${ridepat.Pat.Id}'>${ridepat.Pat.EnglishName}</a>`;
            }

            return isAssistant
                ? patient_English_Name2render + patientAddons
                : patientName2render + patientAddons;
        };

        const buildStatusString = (status) => {
            if (!isAssistant) return status;

            switch (status) {
                case "שובץ נהג":
                    englishStatus = "Driver registered";
                    break;

                case "יצאתי לדרך":
                    englishStatus = "On my way";
                    break;

                case "הגעתי לנקודת האיסוף":
                    englishStatus = "At the pickup point";
                    break;

                case '"הגענו ליעד':
                    englishStatus = "Reached destination";
                    break;

                case "אני אאחר":
                    englishStatus = "I'll be late";
                    break;

                case "עיכוב במחסום":
                    englishStatus = "Delay at the border";
                    break;
                default:
                    englishStatus = "Waiting for a driver";
                    break;
            }

            return englishStatus;
        };


    </script>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <link href="assets/css/manageRidePats.css" rel="stylesheet" />
</head>


<body class="fixed-left">
    <!-- Begin page -->
    <div id="wrapper">
        <!-- Top Bar Start -->
        <div class="topbar">
            <!-- Navbar -->
            <div id="na" class="navbar navbar-default" role="navigation">
                <div class="container">
                    <div class="">
                        <!--Expend/Collaps Side Menue-->
                        <div class="pull-left">
                            <button class="button-menu-mobile open-left waves-effect">
                                <i class="md md-menu"></i>
                            </button>
                            <span class="clearfix"></span>
                        </div>

                        <!-- LOGO -->
                        <div class="pull-left">
                            <div class="text-center">
                                <a href="manageRidePats.html" class="logo"><span>בדרך להחלמה</span>&nbsp&nbsp&nbsp</a>
                            </div>
                        </div>

                        <div class="pull-right">
                            <a href="passwordForm.html"> <span class="logo" id="userName"></span>&nbsp;<span style="color:#3BAFDA" class="logo" id="databaseType"></span></a>
                        </div>
                    </div>
                    <!--/.nav-collapse -->
                </div>
            </div>
        </div>
        <!-- Top Bar End -->
        <!-- ========== Right Sidebar Start ========== -->
        <div id="menuType"></div>
        <div id="wait">
            <img src="../../Media/Wedges-3s-200px.gif" width="64" height="64" />
        </div>
        <!--<div w3-include-html="HelperMenu.html"></div>-->
        <!-- Right Sidebar End -->
        <!-- ============================================================== -->
        <!-- Start page Content here -->
        <!-- ============================================================== -->
        <div class="content-page">
            <!-- Start content -->
            <div class="content">
                <div class="container">

                    <!-- Page-Title -->
                    <div class="row">
                        <div class="col-sm-2">
                            <div class="page-title-box">
                                <h4 class="page-title">
                                    ניהול ההסעות שלי&nbsp&nbsp&nbsp<i data-toggle="tooltip" title="My Rides تنسيق السفريات الخاصة بي">
                                        <img src="../../Media/הסעות להיום.png" height="25" width="25" />
                                    </i>
                                </h4>
                            </div>
                        </div>
                        <div class="col-sm-10  text-right">

                            <span id="allSortsLabel"></span>
                            <label class="switch">
                                <input id="allSortsSwitch" type="checkbox" checked onchange="allSortsSwitch_changed()">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div id="overRideBS_card-box" class="card-box table-responsive">
                                <div class="row">
                                    <div class="col-sm-6 text-left">
                                        <label for="refreshTime">בחירת קצב רענון:</label>
                                        <select id="refreshTime" name="refreshTime" class="input-sm">
                                            <option value="60000">דקה</option>
                                            <option value="120000">2 דקות</option>
                                            <option value="300000">5 דקות</option>
                                            <option value="600000">10 דקות</option>
                                            <option value="1800000">30 דקות</option>
                                            <option value="3600000">60 דקות</option>
                                        </select>
                                    </div>

                                    <div class="col-sm-6 text-right">
                                        <button data-toggle="tooltip"
                                                id="openSortsControllers"
                                                data-placement="top"
                                                title="filters window"
                                                onclick="showFiltersModal()"
                                                class="btn btn-success waves-effect w-md waves-light m-b-5">
                                            <span class="glyphicon glyphicon-filter m-r-5">
                                            </span>
                                            סינון אזורים
                                        </button>

                                        <button data-placement="top"
                                                data-toggle="tooltip"
                                                title="New Ride جديد "
                                                type="button"
                                                id="createCustomer" onclick="newRidePatForm()"
                                                class="btn btn-success waves-effect w-md waves-light m-b-5">
                                            <span class="glyphicon glyphicon-plus-sign m-r-5"></span>
                                            חדש
                                        </button>

                                    </div>
                                </div>

                                <div id="accordion" class="panel-group">
                                    <div onclick="assignTable2lastOne('datatable-morning')" class="panel panel-primary">
                                        <div class="panel-heading" id="col1">
                                            <h4 data-toggle="tooltip" data-placement="top" title="Morning Rides  سفريات الصباح" class="panel-title"> <a href="#collapse1" data-parent="#accordion" data-toggle="collapse" class="dropdown active open">נסיעות לבוקר</a></h4>
                                        </div>
                                        <div class="panel-collapse collapse" id="collapse1">
                                            <div class="panel-body">
                                                <table id="datatable-morning" class="table table-striped table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th class="middle" title="Time  الساعة">שעה</th>
                                                            <th class="middle" title="Origin  نقطة الانطلاق">מוצא</th>
                                                            <th class="middle" title="Destination  نقطة الوصول">יעד</th>
                                                            <th class="customWidth4column middle" title="Patient  المريض">החולה</th>
                                                            <th class="middle" title="Driver  السائق">המסיע</th>
                                                            <th class="middle" title="Status  حالة السفرية">סטטוס ההסעה</th>
                                                            <th class="customWidth middle" title="Last modified">עודכן לאחרונה</th>
                                                            <th class="customWidth middle" title="نقطة الانطلاق - نقطة الوصول Origin - Destination">Org - Dest</th>
                                                            <th class="customWidth  middle" title="Remarks  ملاحظات">הערות</th>
                                                            <th title="isAnonymous"></th> <!-- hidden to the user -->
                                                            <th class="SmallcustomWidth  middle" title="Actions  اعمال">פעולות</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                    <div onclick="assignTable2lastOne('datatable-afternoon')" class="panel panel-primary">
                                        <div class="panel-heading" id="col2">
                                            <h4 data-toggle="tooltip" data-placement="top" title="Afternoon Rides  سفريات المساء" class="panel-title"> <a href="#collapse2" data-parent="#accordion" data-toggle="collapse">נסיעות לאחה"צ</a></h4>
                                        </div>
                                        <div class="panel-collapse collapse" id="collapse2">
                                            <div class="panel-body">
                                                <table id="datatable-afternoon" class="table table-striped table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th class="middle" title="Time  الساعة">שעה</th>
                                                            <th class="middle" title="Origin  نقطة الانطلاق">מוצא</th>
                                                            <th class="middle" title="Destination  نقطة الوصول">יעד</th>
                                                            <th class="customWidth4column middle" title="Patient  المريض">החולה</th>
                                                            <th class="middle" title="Driver  السائق">המסיע</th>
                                                            <th class="middle" title="Status  حالة السفرية">סטטוס ההסעה</th>
                                                            <th class="customWidth middle" title="Last modified">עודכן לאחרונה</th>
                                                            <th class="customWidth middle" title="نقطة الانطلاق - نقطة الوصول Origin - Destination">Org - Dest</th>
                                                            <th class="customWidth  middle" title="Remarks  ملاحظات">הערות</th>
                                                            <th title="isAnonymous"></th> <!-- hidden to the user -->
                                                            <th class="SmallcustomWidth middle" title="Actions  اعمال">פעולות</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                    <div onclick="assignTable2lastOne('datatable-tomorrow')" class="panel panel-primary">
                                        <div class="panel-heading" id="col4">
                                            <h4 data-toggle="tooltip" data-placement="bottom" title="Tomorrow Rides" class="panel-title"> <a href="#collapse3" data-parent="#accordion" data-toggle="collapse">נסיעות למחר</a></h4>
                                        </div>
                                        <div class="panel-collapse collapse" id="collapse3">
                                            <div class="panel-body">
                                                <table id="datatable-tomorrow" class="table table-striped table-bordered hover">
                                                    <thead>
                                                        <tr>
                                                            <th class="middle" title="Date  الساعة">תאריך</th>
                                                            <th class="middle" title="Time  الساعة">שעה</th>
                                                            <th class="middle" title="Origin  نقطة الانطلاق">מוצא</th>
                                                            <th class="middle" title="Destination  نقطة الوصول">יעד</th>
                                                            <th class="customWidth4column middle" title="Patient  المريض">החולה</th>
                                                            <th class="middle" title="Driver  السائق">המסיע</th>
                                                            <th class="middle" title="Status  حالة السفرية">סטטוס ההסעה</th>
                                                            <th class="customWidth middle" title="Last modified">עודכן לאחרונה</th>
                                                            <th class="customWidth middle" title="نقطة الانطلاق - نقطة الوصول Origin - Destination">Org - Dest</th>
                                                            <th class="customWidth  middle" title="Remarks  ملاحظات">הערות</th>
                                                            <th title="isAnonymous"></th> <!-- hidden to the user -->
                                                            <th class="SmallcustomWidth middle" title="Actions  اعمال">פעולות</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                    <div onclick="assignTable2lastOne('datatable-future')" class="panel panel-primary">
                                        <div class="panel-heading" id="col3">
                                            <h4 data-toggle="tooltip" data-placement="bottom" title="Future Rides  سفريات مستقبلية" class="panel-title"> <a href="#collapse4" data-parent="#accordion" data-toggle="collapse">נסיעות עתידיות</a></h4>
                                        </div>
                                        <div class="panel-collapse collapse" id="collapse4">
                                            <div class="panel-body">
                                                <table id="datatable-future" class="table table-striped table-bordered hover">
                                                    <thead>
                                                        <tr>
                                                            <th class="middle" title="Date  الساعة">תאריך</th>
                                                            <th class="middle" title="Time  الساعة">שעה</th>
                                                            <th class="middle" title="Origin  نقطة الانطلاق">מוצא</th>
                                                            <th class="middle" title="Destination  نقطة الوصول">יעד</th>
                                                            <th class="customWidth4column middle" title="Patient  المريض">החולה</th>
                                                            <th class="middle" title="Driver  السائق">המסיע</th>
                                                            <th class="middle" title="Status  حالة السفرية">סטטוס ההסעה</th>
                                                            <th class="customWidth middle" title="Last modified">עודכן לאחרונה</th>
                                                            <th class="customWidth middle" title="نقطة الانطلاق - نقطة الوصول Origin - Destination">Org - Dest</th>
                                                            <th class="customWidth  middle" title="Remarks  ملاحظات">הערות</th>
                                                            <th title="isAnonymous"></th> <!-- hidden to the user -->
                                                            <th class="SmallcustomWidth middle" title="Actions  اعمال">פעולות</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- end container -->

            </div>


            <!-- end content -->
            <!-- FOOTER -->
            <footer id="rights" data-toggle="tooltip" data-placement="top" title="© All rights reserved The Road to Recovery.  جميع الحقوق محفوظة لجمعية الطريق الى الشفاء" class="footer text-right">
            </footer>
            <!-- End FOOTER -->

        </div>
        <!-- ============================================================== -->
        <!-- End page content here -->
        <!-- ============================================================== -->

    </div>
    <!-- END wrapper -->



    <script>
        var resizefunc = [];
    </script>

    <!-- jQuery  -->
    <script src="assets/js/bootstrap-rtl.min.js"></script>
    <script src="assets/js/detect.js"></script>
    <script src="assets/js/fastclick.js"></script>
    <script src="assets/js/jquery.slimscroll.js"></script>
    <script src="assets/js/jquery.blockUI.js"></script>
    <script src="assets/js/waves.js"></script>
    <script src="assets/js/wow.min.js"></script>
    <script src="assets/js/jquery.nicescroll.js"></script>
    <script src="assets/js/jquery.scrollTo.min.js"></script>
    <script src="../plugins/switchery/switchery.min.js"></script>

    <!-- Datatables-->
    <script src="../plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="../plugins/datatables/dataTables.bootstrap.js"></script>
    <script src="../plugins/datatables/dataTables.buttons.min.js"></script>
    <script src="../plugins/datatables/buttons.bootstrap.min.js"></script>
    <script src="../plugins/datatables/jszip.min.js"></script>
    <script src="../plugins/datatables/pdfmake.min.js"></script>
    <script src="../plugins/datatables/vfs_fonts.js"></script>
    <script src="../plugins/datatables/buttons.html5.min.js"></script>
    <script src="../plugins/datatables/buttons.print.min.js"></script>
    <script src="../plugins/datatables/dataTables.fixedHeader.min.js"></script>
    <script src="../plugins/datatables/dataTables.keyTable.min.js"></script>
    <script src="../plugins/datatables/dataTables.responsive.min.js"></script>
    <script src="../plugins/datatables/responsive.bootstrap.min.js"></script>
    <script src="../plugins/datatables/dataTables.scroller.min.js"></script>

    <!-- Datatable init js -->
    <script src="assets/pages/datatables.init.js"></script>

    <!-- Sweet Alert js -->
    <script src="../plugins/bootstrap-sweetalert/sweet-alert.min.js"></script>
    <script src="assets/pages/jquery.sweet-alert.init.js"></script>

    <script src="assets/js/jquery.core.js"></script>
    <script src="assets/js/jquery.app.js"></script>
    <!--<script src="cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.4/moment.min.js"></script>
    <script src="cdn.datatables.net/plug-ins/1.10.19/sorting/datetime-moment.js"></script>-->
    <!--<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.1/jquery.min.js"></script>-->
    <!--<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
    <script src="//cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
    <script src="//cdn.datatables.net/plug-ins/1.10.12/sorting/datetime-moment.js"></script>-->
    <script type="text/javascript">
        TableManageButtons.init();
    </script>

    <div class="modal fade" id="messagesModal" tabindex="-1" role="dialog" aria-labelledby="messagesModalTitle" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title centerHeader" id="messagesModalTitle">נמצאה הסעה חזור</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h5 id="returnRidePatMsg" class="centerHeader"></h5>
                    <h5 id="DriverReturnRidePatMsg" class="centerHeader"></h5>
                </div>
                <div class="modal-footer">
                    <!--<button type="button" class="btn btn-secondary" data-dismiss="modal">ביטול</button>-->
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">ביטול</button>
                    <button type="button" class="btn btn-warning" onclick="deleteReturn()">מחיקה</button>
                </div>
            </div>
        </div>
    </div>



    <!-- ↓ filtersModal ↓ -->
    <div class="modal fade" id="filtersModal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="overRideBS_modal-dialog">
                <div class="modal-header">
                    <h2 class="modal-title">ניהול הסעות - סינון מידע</h2>
                    <h4>רק אזורים מסומנים יופיעו בתצוגה</h4>
                </div>
                <div id="filtersModal_placeHolder" class="modal-body"></div>
                <div class="text-right modal-footer">
                    <button type="button" onclick="saveFilters()" class="btn btn-secondary" data-dismiss="modal">שמירה וסגירה</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">ביטול</button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>