<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="AI Report Generator">
    <meta name="author" content="Road to Recovery">

    <link rel="shortcut icon" href="assets/images/favicon_1.ico">

    <title>יצירת דוח באמצעות AI</title>



    <!-- Sweet Alert css -->
    <link href="../plugins/bootstrap-sweetalert/sweet-alert.css" rel="stylesheet" type="text/css" />

    <link href="../plugins/switchery/switchery.min.css" rel="stylesheet" />
    <link href="assets/css/bootstrap-rtl.min.css" rel="stylesheet" type="text/css">
    <link href="assets/css/core.css" rel="stylesheet" type="text/css">
    <link href="assets/css/icons.css" rel="stylesheet" type="text/css">
    <link href="assets/css/components.css" rel="stylesheet" type="text/css">
    <link href="assets/css/pages.css" rel="stylesheet" type="text/css">
    <link href="assets/css/menu.css" rel="stylesheet" type="text/css">
    <link href="assets/css/responsive.css" rel="stylesheet" type="text/css">

    <script src="assets/js/CookiesFunctions.js"></script>
    <script src="assets/js/modernizr.min.js"></script>

    <!--GENERAL object and additional functions-->
    <script src="lib/lz-string.js"></script>
    <script src="lib/master.js"></script>
    <script src="assets/js/jquery.min.js"></script>
    <script src="lib/includeHTML.js"></script>
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css">
    <!-- DataTables JS (uses the local jQuery already loaded above) -->
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.colVis.min.js"></script>
    <script src="../pages/assets/js/AI_report.js"></script>
    <style>
        .report-container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .section-title {
            color: #5b69bc;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #5b69bc;
        }

        .table-selection-container {
            background: #f7f7f7;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 25px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 4px;
            border: 1px solid #e3e3e3;
            transition: all 0.3s ease;
        }

            .checkbox-item:hover {
                border-color: #5b69bc;
                box-shadow: 0 2px 5px rgba(91,105,188,0.2);
            }

            .checkbox-item input[type="checkbox"] {
                margin-left: 10px;
                width: 18px;
                height: 18px;
                cursor: pointer;
            }

            .checkbox-item label {
                cursor: pointer;
                margin: 0;
                font-size: 14px;
                color: #333;
            }

        .query-input-container {
            margin-bottom: 25px;
        }

        .query-textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #e3e3e3;
            border-radius: 5px;
            font-size: 14px;
            resize: vertical;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: border-color 0.3s ease;
        }

            .query-textarea:focus {
                outline: none;
                border-color: #5b69bc;
            }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        .btn-generate {
            background: linear-gradient(135deg, #5b69bc 0%, #4a5baf 100%);
            color: white;
            padding: 12px 40px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(91,105,188,0.3);
        }

            .btn-generate:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 15px rgba(91,105,188,0.4);
            }

        .btn-clear {
            background: #f5f5f5;
            color: #333;
            padding: 12px 40px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

            .btn-clear:hover {
                background: #e8e8e8;
                border-color: #bbb;
            }

        .results-container {
            margin-top: 30px;
            padding: 25px;
            background: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #e3e3e3;
            display: none;
        }

            .results-container.active {
                display: block;
            }

        .info-box {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-right: 4px solid #2196F3;
        }

            .info-box i {
                color: #2196F3;
                margin-left: 10px;
            }

        .selected-tables-preview {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 5px;
            border: 1px dashed #5b69bc;
        }

            .selected-tables-preview h4 {
                color: #5b69bc;
                font-size: 14px;
                margin-bottom: 10px;
            }

        .selected-table-tag {
            display: inline-block;
            background: #5b69bc;
            color: white;
            padding: 5px 12px;
            margin: 5px;
            border-radius: 15px;
            font-size: 12px;
        }

        .example-queries-container {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 25px;
            border-right: 4px solid #ffc107;
        }

        .example-queries-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding: 5px 0;
        }

            .example-queries-header:hover {
                opacity: 0.8;
            }

        .example-queries-toggle {
            background: #ffc107;
            color: #856404;
            border: none;
            padding: 5px 15px;
            border-radius: 3px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

            .example-queries-toggle:hover {
                background: #e0a800;
            }

        .example-queries-list {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
            padding: 0;
        }

            .example-queries-list.expanded {
                max-height: 500px;
                overflow-y: auto;
                padding: 10px 0;
            }

        .example-category {
            margin-bottom: 15px;
        }

            .example-category h5 {
                color: #5b69bc;
                font-weight: bold;
                font-size: 13px;
                margin: 10px 0 8px 0;
            }

        .example-item {
            background: white;
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 4px;
            border: 1px solid #e3e3e3;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 13px;
            color: #333;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

            .example-item:hover {
                background: #5b69bc;
                color: white;
                border-color: #5b69bc;
                transform: translateX(-3px);
                box-shadow: 0 2px 5px rgba(91,105,188,0.3);
            }

            .example-item:active {
                transform: translateX(-3px);
            }

        .example-queries-list::-webkit-scrollbar {
            width: 8px;
        }

        .example-queries-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .example-queries-list::-webkit-scrollbar-thumb {
            background: #ffc107;
            border-radius: 10px;
        }

            .example-queries-list::-webkit-scrollbar-thumb:hover {
                background: #e0a800;
            }

        .columns-selection-container {
            margin-top: 20px;
            display: none;
        }

            .columns-selection-container.active {
                display: block;
            }

        .table-columns-section {
            background: white;
            border: 1px solid #e3e3e3;
            border-radius: 5px;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .table-columns-header {
            background: linear-gradient(135deg, #5b69bc 0%, #4a5baf 100%);
            color: white;
            padding: 12px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

            .table-columns-header:hover {
                opacity: 0.95;
            }

            .table-columns-header h4 {
                margin: 0;
                font-size: 14px;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .table-columns-header .toggle-icon {
                transition: transform 0.3s ease;
            }

            .table-columns-header.collapsed .toggle-icon {
                transform: rotate(-90deg);
            }

        .table-columns-actions {
            display: flex;
            gap: 10px;
        }

        .btn-select-all, .btn-clear-all {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 4px 12px;
            border-radius: 3px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

            .btn-select-all:hover, .btn-clear-all:hover {
                background: rgba(255,255,255,0.3);
            }

        .table-columns-body {
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

            .table-columns-body.collapsed {
                max-height: 0;
                padding: 0 15px;
                overflow: hidden;
            }

        .columns-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 8px;
        }

        .column-item {
            display: flex;
            align-items: center;
            padding: 8px 10px;
            background: #f9f9f9;
            border-radius: 4px;
            border: 1px solid #eee;
            transition: all 0.2s ease;
        }

            .column-item:hover {
                border-color: #5b69bc;
                background: #f0f2ff;
            }

            .column-item input[type="checkbox"] {
                margin-left: 8px;
                width: 16px;
                height: 16px;
                cursor: pointer;
            }

            .column-item label {
                cursor: pointer;
                margin: 0;
                font-size: 13px;
                color: #333;
                flex: 1;
            }

            .column-item .data-type {
                font-size: 10px;
                color: #888;
                background: #e9e9e9;
                padding: 2px 6px;
                border-radius: 3px;
                margin-right: 5px;
            }

        .selected-count-badge {
            background: rgba(255,255,255,0.3);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            margin-right: 10px;
        }

        .token-savings-info {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 12px 15px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

            .token-savings-info i {
                color: #28a745;
                font-size: 18px;
            }

            .token-savings-info .savings-text {
                font-size: 13px;
                color: #155724;
            }

            .token-savings-info .savings-number {
                font-weight: bold;
                color: #28a745;
            }
    </style>

    <style>
        /* ===== DataTable Results Styling ===== */
        #resultsContent {
            overflow-x: auto;
            max-width: 100%;
        }

        .datatable-scroll-wrapper {
            overflow-x: auto;
            width: 100%;
            -webkit-overflow-scrolling: touch;
        }

        /* Force DataTables wrapper to respect container bounds */
        #resultsContent .dataTables_wrapper {
            width: 100% !important;
            overflow: visible;
        }

        /* Ensure the scrollable body stays within bounds */
        #resultsContent .dataTables_scrollBody {
            overflow-x: auto !important;
        }

        /* Table styling - explicit borders and padding */
        #resultsContent table.dataTable,
        #resultsContent table.ai-report-table {
            border-collapse: collapse !important;
            width: 100% !important;
            margin: 0 !important;
        }

        #resultsContent table.dataTable thead th,
        #resultsContent table.ai-report-table thead th {
            background-color: #5b69bc !important;
            color: #fff !important;
            border: 1px solid #4a5baf !important;
            padding: 10px 14px !important;
            font-size: 13px;
            font-weight: bold;
            text-align: right;
            white-space: nowrap;
        }

        #resultsContent table.dataTable tbody td,
        #resultsContent table.ai-report-table tbody td {
            border: 1px solid #ddd !important;
            padding: 8px 12px !important;
            font-size: 13px;
            text-align: right;
            vertical-align: middle;
        }

        #resultsContent table.dataTable tbody tr:nth-child(even),
        #resultsContent table.ai-report-table tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        #resultsContent table.dataTable tbody tr:hover,
        #resultsContent table.ai-report-table tbody tr:hover {
            background-color: #eef0fb !important;
        }

        /* DataTable controls styling */
        #resultsContent .dataTables_filter {
            margin-bottom: 10px;
        }

        #resultsContent .dataTables_filter input {
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 5px 10px;
            margin-right: 5px;
        }

        #resultsContent .dataTables_info {
            padding-top: 10px;
            font-size: 13px;
            color: #666;
        }

        #resultsContent .dataTables_paginate {
            padding-top: 10px;
        }

        #resultsContent .dataTables_paginate .paginate_button {
            padding: 4px 12px !important;
            margin: 0 2px;
            border: 1px solid #ddd !important;
            border-radius: 3px;
            background: #fff !important;
            color: #333 !important;
            cursor: pointer;
        }

        #resultsContent .dataTables_paginate .paginate_button.current {
            background: #5b69bc !important;
            color: #fff !important;
            border-color: #5b69bc !important;
        }

        #resultsContent .dataTables_paginate .paginate_button:hover:not(.current) {
            background: #eef0fb !important;
            border-color: #5b69bc !important;
            color: #5b69bc !important;
        }

        /* Export buttons styling */
        #resultsContent .dt-buttons {
            margin-bottom: 10px;
        }

        #resultsContent .dt-buttons .dt-button {
            background: linear-gradient(135deg, #5b69bc 0%, #4a5baf 100%) !important;
            color: #fff !important;
            border: none !important;
            padding: 6px 16px !important;
            border-radius: 4px;
            margin-left: 5px;
            font-size: 13px;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        #resultsContent .dt-buttons .dt-button:hover {
            opacity: 0.85;
        }

        /* Sorting arrows override */
        #resultsContent table.dataTable thead .sorting::after,
        #resultsContent table.dataTable thead .sorting_asc::after,
        #resultsContent table.dataTable thead .sorting_desc::after {
            opacity: 0.8;
        }
    </style>

    <style>
        /* ===== AI LOADER - ALL SCOPED WITH .ai-loader PREFIX ===== */
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500&display=swap');

        .ai-loader-overlay {
            position: fixed;
            inset: 0;
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(5, 6, 15, 0.72);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            font-family: 'Orbitron', monospace;
            transition: opacity 0.4s ease;
        }

            .ai-loader-overlay.hidden {
                display: none;
            }

            /* Grid background */
            .ai-loader-overlay::before {
                content: '';
                position: absolute;
                inset: 0;
                background: linear-gradient(90deg, rgba(0,240,255,0.03) 1px, transparent 1px), linear-gradient(rgba(0,240,255,0.03) 1px, transparent 1px);
                background-size: 40px 40px;
                animation: aiL-gridPulse 4s ease-in-out infinite;
                pointer-events: none;
            }

        @keyframes aiL-gridPulse {
            0%, 100% {
                opacity: 0.3;
            }

            50% {
                opacity: 0.8;
            }
        }

        /* Particles */
        .ai-loader-ambient {
            position: absolute;
            inset: 0;
            pointer-events: none;
        }

        .ai-loader-particle {
            position: absolute;
            border-radius: 50%;
            opacity: 0;
            animation: aiL-float var(--duration) var(--delay) infinite ease-in-out;
        }

        @keyframes aiL-float {
            0% {
                opacity: 0;
                transform: translateY(100vh) scale(0);
            }

            10% {
                opacity: 0.8;
            }

            90% {
                opacity: 0.6;
            }

            100% {
                opacity: 0;
                transform: translateY(-20vh) scale(1.5);
            }
        }

        /* Data Streams */
        .ai-loader-stream {
            position: absolute;
            top: 0;
            width: 1px;
            height: 100%;
            opacity: 0.06;
            pointer-events: none;
        }

            .ai-loader-stream::before {
                content: '01001 10110 AI 01 NEURAL 10 DEEP 01 THINK';
                position: absolute;
                top: 0;
                font-family: 'Orbitron', monospace;
                font-size: 8px;
                color: #00f0ff;
                writing-mode: vertical-rl;
                white-space: nowrap;
                animation: aiL-streamDown var(--speed) linear infinite;
                animation-delay: var(--delay);
            }

        @keyframes aiL-streamDown {
            0% {
                transform: translateY(-100%);
            }

            100% {
                transform: translateY(100vh);
            }
        }

        /* Corners */
        .ai-loader-corner {
            position: absolute;
            width: 80px;
            height: 80px;
            pointer-events: none;
            opacity: 0.15;
        }

            .ai-loader-corner::before, .ai-loader-corner::after {
                content: '';
                position: absolute;
                background: #00f0ff;
            }

            .ai-loader-corner::before {
                width: 30px;
                height: 1px;
            }

            .ai-loader-corner::after {
                width: 1px;
                height: 30px;
            }

            .ai-loader-corner.tl {
                top: 20px;
                left: 20px;
            }

            .ai-loader-corner.tr {
                top: 20px;
                right: 20px;
            }

                .ai-loader-corner.tr::before {
                    right: 0;
                }

                .ai-loader-corner.tr::after {
                    right: 0;
                }

            .ai-loader-corner.bl {
                bottom: 20px;
                left: 20px;
            }

                .ai-loader-corner.bl::before {
                    bottom: 0;
                }

                .ai-loader-corner.bl::after {
                    bottom: 0;
                }

            .ai-loader-corner.br {
                bottom: 20px;
                right: 20px;
            }

                .ai-loader-corner.br::before {
                    right: 0;
                    bottom: 0;
                }

                .ai-loader-corner.br::after {
                    right: 0;
                    bottom: 0;
                }

        /* Core Container */
        .ai-loader-core {
            position: relative;
            width: 280px;
            height: 280px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Aura */
        .ai-loader-aura {
            position: absolute;
            width: 350px;
            height: 350px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(0,240,255,0.06) 0%, rgba(139,92,246,0.04) 30%, rgba(255,0,229,0.02) 50%, transparent 70%);
            animation: aiL-aura 4s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes aiL-aura {
            0%, 100% {
                transform: scale(0.9);
                opacity: 0.6;
            }

            50% {
                transform: scale(1.15);
                opacity: 1;
            }
        }

        /* Neural connections */
        .ai-loader-neural {
            position: absolute;
            width: 280px;
            height: 280px;
        }

            .ai-loader-neural svg {
                width: 100%;
                height: 100%;
                position: absolute;
                top: 0;
                left: 0;
            }

        .ai-loader-synapse {
            stroke-width: 0.5;
            stroke-dasharray: 5 8;
            opacity: 0.4;
            animation: aiL-synapse 2s linear infinite;
        }

            .ai-loader-synapse:nth-child(odd) {
                stroke: #00f0ff;
                animation-duration: 2.5s;
            }

            .ai-loader-synapse:nth-child(even) {
                stroke: #ff00e5;
                animation-duration: 1.8s;
            }

        @keyframes aiL-synapse {
            to {
                stroke-dashoffset: -50;
            }
        }

        /* Hex nodes */
        .ai-loader-hexnodes {
            position: absolute;
            width: 300px;
            height: 300px;
        }

        .ai-loader-hex {
            position: absolute;
            width: 12px;
            height: 14px;
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            animation: aiL-hex 2s ease-in-out infinite;
        }

            .ai-loader-hex:nth-child(1) {
                top: 0;
                left: 50%;
                background: #00f0ff;
                animation-delay: 0s;
            }

            .ai-loader-hex:nth-child(2) {
                top: 20%;
                right: 5%;
                background: #ff00e5;
                animation-delay: 0.3s;
            }

            .ai-loader-hex:nth-child(3) {
                bottom: 20%;
                right: 5%;
                background: #8b5cf6;
                animation-delay: 0.6s;
            }

            .ai-loader-hex:nth-child(4) {
                bottom: 0;
                left: 50%;
                background: #00ffaa;
                animation-delay: 0.9s;
            }

            .ai-loader-hex:nth-child(5) {
                bottom: 20%;
                left: 5%;
                background: #00f0ff;
                animation-delay: 1.2s;
            }

            .ai-loader-hex:nth-child(6) {
                top: 20%;
                left: 5%;
                background: #ff00e5;
                animation-delay: 1.5s;
            }

        @keyframes aiL-hex {
            0%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }

            50% {
                opacity: 1;
                transform: scale(1.4);
                filter: drop-shadow(0 0 8px currentColor);
            }
        }

        /* Scan arc */
        .ai-loader-scan {
            position: absolute;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            animation: aiL-orbit 6s linear infinite;
        }

            .ai-loader-scan::before {
                content: '';
                position: absolute;
                top: 0;
                left: 50%;
                width: 50%;
                height: 50%;
                background: conic-gradient(from 0deg, transparent, rgba(0,240,255,0.15));
                transform-origin: bottom left;
                border-radius: 0 100% 0 0;
                filter: blur(5px);
            }

        /* Orbital Rings */
        .ai-loader-ring {
            position: absolute;
            border-radius: 50%;
            border: 1px solid transparent;
        }

            .ai-loader-ring:nth-child(6) {
                width: 280px;
                height: 280px;
                border-top-color: #00f0ff;
                border-right-color: rgba(0,240,255,0.2);
                animation: aiL-orbit 3s linear infinite;
                filter: drop-shadow(0 0 8px #00f0ff);
            }

            .ai-loader-ring:nth-child(7) {
                width: 240px;
                height: 240px;
                border-bottom-color: #ff00e5;
                border-left-color: rgba(255,0,229,0.2);
                animation: aiL-orbit 2.5s linear infinite reverse;
                filter: drop-shadow(0 0 8px #ff00e5);
            }

            .ai-loader-ring:nth-child(8) {
                width: 200px;
                height: 200px;
                border-top-color: #8b5cf6;
                border-right-color: rgba(139,92,246,0.3);
                animation: aiL-orbit 2s linear infinite;
                filter: drop-shadow(0 0 6px #8b5cf6);
            }

            .ai-loader-ring:nth-child(9) {
                width: 160px;
                height: 160px;
                border-bottom-color: #00ffaa;
                border-left-color: rgba(0,255,170,0.2);
                animation: aiL-orbit 4s linear infinite reverse;
                filter: drop-shadow(0 0 6px #00ffaa);
            }

        @keyframes aiL-orbit {
            to {
                transform: rotate(360deg);
            }
        }

        /* Electron dots on rings */
        .ai-loader-ring::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            top: -4px;
            left: 50%;
            transform: translateX(-50%);
        }

        .ai-loader-ring:nth-child(6)::after {
            background: #00f0ff;
            box-shadow: 0 0 15px 5px #00f0ff, 0 0 30px 10px rgba(0,240,255,0.3);
        }

        .ai-loader-ring:nth-child(7)::after {
            background: #ff00e5;
            box-shadow: 0 0 15px 5px #ff00e5, 0 0 30px 10px rgba(255,0,229,0.3);
        }

        .ai-loader-ring:nth-child(8)::after {
            background: #8b5cf6;
            box-shadow: 0 0 15px 5px #8b5cf6;
        }

        .ai-loader-ring:nth-child(9)::after {
            background: #00ffaa;
            box-shadow: 0 0 15px 5px #00ffaa;
        }

        /* Brain */
        .ai-loader-brain {
            position: absolute;
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

            .ai-loader-brain::before {
                content: '';
                position: absolute;
                width: 100%;
                height: 100%;
                border-radius: 50%;
                background: radial-gradient(circle, rgba(0,240,255,0.15) 0%, rgba(139,92,246,0.1) 40%, transparent 70%);
                animation: aiL-core 2s ease-in-out infinite;
            }

        @keyframes aiL-core {
            0%, 100% {
                transform: scale(1);
                opacity: 0.8;
            }

            50% {
                transform: scale(1.3);
                opacity: 1;
            }
        }

        .ai-loader-brain-svg {
            width: 60px;
            height: 60px;
            position: relative;
            z-index: 2;
            filter: drop-shadow(0 0 10px #00f0ff) drop-shadow(0 0 20px rgba(0,240,255,0.3));
        }

            .ai-loader-brain-svg path {
                fill: none;
                stroke-width: 1.5;
                stroke-linecap: round;
                stroke-dasharray: 200;
                stroke-dashoffset: 200;
                animation: aiL-draw 3s ease-in-out infinite alternate;
            }

        .ai-loader-lhemi path {
            stroke: #00f0ff;
        }

        .ai-loader-rhemi path {
            stroke: #ff00e5;
            animation-delay: 0.3s;
        }

        @keyframes aiL-draw {
            0% {
                stroke-dashoffset: 200;
            }

            100% {
                stroke-dashoffset: 0;
            }
        }

        .ai-loader-dots circle {
            fill: #00f0ff;
            opacity: 0;
            animation: aiL-fire 1.5s ease-in-out infinite;
        }

            .ai-loader-dots circle:nth-child(2) {
                animation-delay: 0.2s;
                fill: #ff00e5;
            }

            .ai-loader-dots circle:nth-child(3) {
                animation-delay: 0.4s;
                fill: #8b5cf6;
            }

            .ai-loader-dots circle:nth-child(4) {
                animation-delay: 0.6s;
                fill: #00ffaa;
            }

            .ai-loader-dots circle:nth-child(5) {
                animation-delay: 0.8s;
                fill: #00f0ff;
            }

            .ai-loader-dots circle:nth-child(6) {
                animation-delay: 1.0s;
                fill: #ff00e5;
            }

        @keyframes aiL-fire {
            0%, 100% {
                opacity: 0.2;
                r: 1.5;
            }

            50% {
                opacity: 1;
                r: 3;
            }
        }

        /* Text */
        .ai-loader-text {
            position: absolute;
            bottom: -80px;
            text-align: center;
            width: 350px;
        }

        .ai-loader-title {
            font-family: 'Orbitron', monospace;
            font-weight: 900;
            font-size: 14px;
            letter-spacing: 8px;
            text-transform: uppercase;
            background: linear-gradient(90deg, #00f0ff, #ff00e5, #8b5cf6, #00ffaa);
            background-size: 300% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: aiL-grad 3s ease-in-out infinite;
            margin-bottom: 12px;
        }

        @keyframes aiL-grad {
            0%, 100% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }
        }

        .ai-loader-thinking {
            font-family: 'Rajdhani', sans-serif;
            font-weight: 300;
            font-size: 13px;
            color: rgba(255,255,255,0.4);
            letter-spacing: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2px;
        }

        .ai-loader-word {
            animation: aiL-wordFade 4s ease-in-out infinite;
        }

        @keyframes aiL-wordFade {
            0%, 100% {
                opacity: 0.4;
            }

            50% {
                opacity: 0.9;
            }
        }

        .ai-loader-tdots span {
            display: inline-block;
            animation: aiL-dotB 1.4s ease-in-out infinite;
            color: #00f0ff;
        }

            .ai-loader-tdots span:nth-child(1) {
                animation-delay: 0s;
            }

            .ai-loader-tdots span:nth-child(2) {
                animation-delay: 0.2s;
            }

            .ai-loader-tdots span:nth-child(3) {
                animation-delay: 0.4s;
            }

        @keyframes aiL-dotB {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.3;
            }

            30% {
                transform: translateY(-6px);
                opacity: 1;
            }
        }

        .ai-loader-progress {
            width: 200px;
            height: 2px;
            background: rgba(255,255,255,0.05);
            border-radius: 1px;
            margin: 14px auto 0;
            overflow: hidden;
        }

        .ai-loader-progress-fill {
            height: 100%;
            width: 40%;
            border-radius: 1px;
            background: linear-gradient(90deg, #00f0ff, #ff00e5);
            animation: aiL-sweep 2s ease-in-out infinite;
            box-shadow: 0 0 10px #00f0ff, 0 0 20px rgba(0,240,255,0.3);
        }

        @keyframes aiL-sweep {
            0% {
                transform: translateX(-100%);
            }

            100% {
                transform: translateX(350%);
            }
        }

        .ai-loader-status {
            font-family: 'Rajdhani', sans-serif;
            font-size: 10px;
            letter-spacing: 4px;
            text-transform: uppercase;
            color: rgba(255,255,255,0.2);
            margin-top: 10px;
            height: 14px;
            overflow: hidden;
        }

        .ai-loader-status-inner {
            animation: aiL-statusScroll 8s step-end infinite;
        }

        .ai-loader-status-item {
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes aiL-statusScroll {
            0% {
                transform: translateY(0);
            }

            25% {
                transform: translateY(-14px);
            }

            50% {
                transform: translateY(-28px);
            }

            75% {
                transform: translateY(-42px);
            }

            100% {
                transform: translateY(0);
            }
        }
    </style>

</head>

<body class="fixed-left">
    <!-- Begin page -->
    <div id="wrapper">
        <!-- Top Bar Start -->
        <div class="topbar">
            <!-- Navbar -->
            <div id="na" class="navbar navbar-default" role="navigation">
                <div class="container">
                    <div class="">
                        <!--Expend/Collaps Side Menu-->
                        <div class="pull-left">
                            <button class="button-menu-mobile open-left waves-effect">
                                <i class="md md-menu"></i>
                            </button>
                            <span class="clearfix"></span>
                        </div>

                        <!-- LOGO -->
                        <div class="pull-left">
                            <div class="text-center">
                                <a href="manageRidePats.html" class="logo"><span>בדרך להחלמה</span></a>
                            </div>
                        </div>
                        <div class="pull-right">
                            <a href="passwordForm.html"> <span class="logo" id="userName"></span></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Top Bar End -->
        <!-- Right Sidebar Start -->
        <div w3-include-html="menu.html"></div>
        <!-- Right Sidebar End -->
        <!-- Start page Content here -->
        <div class="content-page">
            <!-- Start content -->
            <div class="content">
                <div class="container">
                    <!-- Page-Title -->
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="page-title-box">
                                <ol class="breadcrumb pull-right">
                                    <li class="active">יצירת דוח AI</li>
                                </ol>
                                <h4 class="page-title">
                                    מחולל דוחות חכם&nbsp&nbsp
                                    <i class="fa fa-magic" style="font-size: 24px; color: #5b69bc;"></i>
                                </h4>
                            </div>
                        </div>
                    </div>

                    <!-- Main Content -->
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="report-container">

                                <!-- Info Box -->
                                <div class="info-box">
                                    <i class="fa fa-info-circle"></i>
                                    <strong>כיצד להשתמש:</strong>
                                    בחרו את הטבלאות הרלוונטיות מהמערכת, הזינו את השאילתה שלכם בשפה חופשית, והמערכת תייצר עבורכם דוח מותאם אישית באמצעות בינה מלאכותית.
                                </div>

                                <!-- Table Selection Section -->
                                <div class="table-selection-container">
                                    <div class="section-title">
                                        <i class="fa fa-table"></i>
                                        בחירת טבלאות מהמערכת
                                    </div>

                                    <div class="checkbox-group">
                                        <div class="checkbox-item">
                                            <input type="checkbox" id="table_volunteers" value="Volunteer" onchange="onTableSelectionChange('Volunteer', this.checked)">
                                            <label for="table_volunteers">מתנדבים</label>
                                        </div>

                                        <div class="checkbox-item">
                                            <input type="checkbox" id="table_patients" value="Patient" onchange="onTableSelectionChange('Patient', this.checked)">
                                            <label for="table_patients">חולים</label>
                                        </div>

                                        <div class="checkbox-item">
                                            <input type="checkbox" id="table_rides" value="UnityRide" onchange="onTableSelectionChange('UnityRide', this.checked)">
                                            <label for="table_rides">הסעות</label>
                                        </div>
                                    </div>

                                    <!-- Selected Tables Preview -->
                                    <div class="selected-tables-preview">
                                        <h4><i class="fa fa-check-circle"></i> טבלאות נבחרות:</h4>
                                        <div id="selectedTablesPreview">
                                            <em style="color: #999;">לא נבחרו טבלאות</em>
                                        </div>
                                    </div>

                                    <!-- Column Selection Section (Dynamic) -->
                                    <div id="columnsSelectionContainer" class="columns-selection-container">
                                        <div class="section-title" style="margin-top: 20px; font-size: 16px;">
                                            <i class="fa fa-columns"></i>
                                            בחירת עמודות (לחסכון בטוקנים)
                                        </div>
                                        <div id="columnsSelectionContent">
                                            <!-- Dynamic column checkboxes will be inserted here -->
                                        </div>
                                        <div id="tokenSavingsInfo" class="token-savings-info" style="display: none;">
                                            <i class="fa fa-leaf"></i>
                                            <span class="savings-text">
                                                חיסכון משוער: <span id="savingsPercent" class="savings-number">0%</span> מהטוקנים
                                                (<span id="selectedColsCount">0</span> עמודות נבחרו מתוך <span id="totalColsCount">0</span>)
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Example Queries Section -->
                                <div class="example-queries-container">
                                    <div class="example-queries-header" onclick="toggleExampleQueries()">
                                        <div>
                                            <i class="fa fa-lightbulb-o"></i>
                                            <strong style="color: #856404;">דוגמאות לשאילתות</strong>
                                            <span style="font-size: 12px; color: #856404; margin-right: 10px;">(לחצו להצגה/הסתרה)</span>
                                        </div>
                                        <button class="example-queries-toggle" id="toggleButton">
                                            <i class="fa fa-chevron-down"></i>
                                        </button>
                                    </div>

                                    <div class="example-queries-list" id="exampleQueriesList">
                                        <!-- Volunteers Examples -->
                                        <div class="example-category">
                                            <h5>
                                                <i class="fa fa-users"></i> מתנדבים:
                                            </h5>
                                            <div class="example-item" onclick="setExampleQuery(this.innerText)">
                                                הצג את כל המתנדבים הפעילים כולל שם מלא, טלפון, עיר ותאריך הצטרפות
                                            </div>
                                            <div class="example-item" onclick="setExampleQuery(this.innerText)">
                                                הצג מתנדבים שביצעו יותר מ-10 הסעות בחודש האחרון
                                            </div>
                                        </div>

                                        <!-- Patients Examples -->
                                        <div class="example-category">
                                            <h5>
                                                <i class="fa fa-wheelchair"></i> חולים:
                                            </h5>
                                            <div class="example-item" onclick="setExampleQuery(this.innerText)">
                                                הצג חולים פעילים עם מספר טלפון וכתובת מלאה
                                            </div>
                                            <div class="example-item" onclick="setExampleQuery(this.innerText)">
                                                מצא חולים שקיבלו יותר מ-15 הסעות החודש
                                            </div>
                                        </div>

                                        <!-- Rides Examples -->
                                        <div class="example-category">
                                            <h5>
                                                <i class="fa fa-car"></i> הסעות:
                                            </h5>
                                            <div class="example-item" onclick="setExampleQuery(this.innerText)">
                                                הצג את כל ההסעות שבוצעו השבוע כולל תאריך, מתנדב וחולה
                                            </div>
                                            <div class="example-item" onclick="setExampleQuery(this.innerText)">
                                                הצג סטטיסטיקה של הסעות לפי ערים
                                            </div>
                                        </div>

                                        <!-- Combined Queries Examples -->
                                        <div class="example-category">
                                            <h5>
                                                <i class="fa fa-link"></i> שאילתות משולבות:
                                            </h5>
                                            <div class="example-item" onclick="setExampleQuery(this.innerText)">
                                                מצא את 10 המתנדבים הפעילים ביותר בחודש האחרון
                                            </div>
                                            <div class="example-item" onclick="setExampleQuery(this.innerText)">
                                                הצג דוח חודשי: סך הסעות, מתנדבים פעילים, חולים ששורתו
                                            </div>
                                        </div>

                                        <!-- Statistics Examples -->
                                        <div class="example-category">
                                            <h5>
                                                <i class="fa fa-bar-chart"></i> סטטיסטיקות:
                                            </h5>
                                            <div class="example-item" onclick="setExampleQuery(this.innerText)">
                                                הצג התפלגות הסעות לפי ימים בשבוע
                                            </div>
                                            <div class="example-item" onclick="setExampleQuery(this.innerText)">
                                                הצג מגמת צמיחה - הסעות לפי חודשים ב-6 חודשים האחרונים
                                            </div>
                                        </div>
                                    </div>

                                    <div style="margin-top: 10px; padding-top: 10px; border-top: 1px dashed #ffc107; font-size: 12px;">
                                        <p style="color: #856404; margin: 0;">
                                            <i class="fa fa-database"></i>
                                            <strong>טיפ:</strong> ניתן לשלב טבלאות ולבקש מידע מורכב בשפה טבעית
                                        </p>
                                    </div>
                                </div>

                                <!-- Query Input Section -->
                                <div class="query-input-container">
                                    <div class="section-title">
                                        <i class="fa fa-pencil"></i>
                                        הזינו את שאילתת הדוח בשפה חופשית
                                    </div>
                                    <textarea id="queryInput"
                                              class="query-textarea"
                                              placeholder="לדוגמה: הצג לי את כל המתנדבים שביצעו יותר מ-10 הסעות בחודש האחרון, כולל פרטי ההסעות והחולים שהסיעו..."></textarea>
                                </div>

                                <!-- Action Buttons -->
                                <div class="action-buttons">
                                    <button class="btn-generate" onclick="generateReport()">
                                        <i class="fa fa-magic"></i>
                                        צור דוח
                                    </button>
                                    <button class="btn-clear" onclick="clearSelections()">
                                        <i class="fa fa-refresh"></i>
                                        נקה הכל
                                    </button>
                                </div>

                                <!-- Results Container (Initially Hidden) -->
                                <div id="resultsContainer" class="results-container">
                                    <div class="section-title">
                                        <i class="fa fa-bar-chart"></i>
                                        תוצאות הדוח
                                    </div>
                                    <div id="resultsContent">
                                        <!-- Results will be displayed here -->
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <!-- Loading Indicator -->
                    <div id="wait" style="display:none;width:69px;height:89px;position:fixed;z-index:9999;top:50%;left:50%;padding:2px;transform:translate(-50%, -50%);">
                        <img src="../../Media/Wedges-3s-200px.gif" width="64" height="64" />
                    </div>

                </div>
                <!-- end container -->
            </div>
            <!-- end content -->
            <!-- FOOTER -->
            <footer id="rights" data-toggle="tooltip" data-placement="top" title="© All rights reserved The Road to Recovery.  جميع الحقوق محفوظة لجمعية الطريق الى الشفاء" class="footer text-right">
            </footer>
            <!-- End FOOTER -->

        </div>
        <!-- End page content -->
    </div>
    <!-- END wrapper -->
    <!--NEW LOADER-->

    <div id="ai-loader" class="ai-loader-overlay">
        <!-- Ambient Particles -->
        <div class="ai-loader-ambient" id="ai-loader-particles"></div>

        <!-- Data Streams -->
        <div class="ai-loader-stream" style="left: 8%; --speed: 8s; --delay: 0s;"></div>
        <div class="ai-loader-stream" style="left: 22%; --speed: 12s; --delay: 2s;"></div>
        <div class="ai-loader-stream" style="left: 45%; --speed: 10s; --delay: 4s;"></div>
        <div class="ai-loader-stream" style="left: 67%; --speed: 9s; --delay: 1s;"></div>
        <div class="ai-loader-stream" style="left: 85%; --speed: 11s; --delay: 3s;"></div>
        <div class="ai-loader-stream" style="left: 93%; --speed: 7s; --delay: 5s;"></div>

        <!-- Corner Decorations -->
        <div class="ai-loader-corner tl"></div>
        <div class="ai-loader-corner tr"></div>
        <div class="ai-loader-corner bl"></div>
        <div class="ai-loader-corner br"></div>

        <!-- Core -->
        <div class="ai-loader-core">
            <div class="ai-loader-aura"></div>

            <!-- Neural Lines -->
            <div class="ai-loader-neural">
                <svg viewBox="0 0 280 280">
                    <line class="ai-loader-synapse" x1="140" y1="0" x2="70" y2="70" />
                    <line class="ai-loader-synapse" x1="140" y1="0" x2="210" y2="70" />
                    <line class="ai-loader-synapse" x1="280" y1="140" x2="210" y2="70" />
                    <line class="ai-loader-synapse" x1="280" y1="140" x2="210" y2="210" />
                    <line class="ai-loader-synapse" x1="140" y1="280" x2="210" y2="210" />
                    <line class="ai-loader-synapse" x1="140" y1="280" x2="70" y2="210" />
                    <line class="ai-loader-synapse" x1="0" y1="140" x2="70" y2="210" />
                    <line class="ai-loader-synapse" x1="0" y1="140" x2="70" y2="70" />
                    <line class="ai-loader-synapse" x1="70" y1="70" x2="210" y2="210" />
                    <line class="ai-loader-synapse" x1="210" y1="70" x2="70" y2="210" />
                    <line class="ai-loader-synapse" x1="140" y1="0" x2="140" y2="280" />
                    <line class="ai-loader-synapse" x1="0" y1="140" x2="280" y2="140" />
                </svg>
            </div>

            <!-- Hex Nodes -->
            <div class="ai-loader-hexnodes">
                <div class="ai-loader-hex"></div>
                <div class="ai-loader-hex"></div>
                <div class="ai-loader-hex"></div>
                <div class="ai-loader-hex"></div>
                <div class="ai-loader-hex"></div>
                <div class="ai-loader-hex"></div>
            </div>

            <!-- Scan Arc -->
            <div class="ai-loader-scan"></div>

            <!-- Orbital Rings -->
            <div class="ai-loader-ring"></div>
            <div class="ai-loader-ring"></div>
            <div class="ai-loader-ring"></div>
            <div class="ai-loader-ring"></div>

            <!-- Brain -->
            <div class="ai-loader-brain">
                <svg class="ai-loader-brain-svg" viewBox="0 0 50 50">
                    <g class="ai-loader-lhemi">
                        <path d="M25,8 Q12,8 10,18 Q8,28 14,35 Q18,40 25,42" />
                        <path d="M25,12 Q16,14 14,22 Q12,30 18,36" />
                        <path d="M25,18 Q19,20 18,26" />
                    </g>
                    <g class="ai-loader-rhemi">
                        <path d="M25,8 Q38,8 40,18 Q42,28 36,35 Q32,40 25,42" />
                        <path d="M25,12 Q34,14 36,22 Q38,30 32,36" />
                        <path d="M25,18 Q31,20 32,26" />
                    </g>
                    <g class="ai-loader-dots">
                        <circle cx="14" cy="20" r="2" />
                        <circle cx="36" cy="20" r="2" />
                        <circle cx="20" cy="30" r="2" />
                        <circle cx="30" cy="30" r="2" />
                        <circle cx="25" cy="15" r="2" />
                        <circle cx="25" cy="38" r="2" />
                    </g>
                </svg>
            </div>

            <!-- Text -->
            <div class="ai-loader-text">
                <div class="ai-loader-title">AI Processing</div>
                <div class="ai-loader-thinking">
                    <span class="ai-loader-word">Thinking</span>
                    <span class="ai-loader-tdots"><span>.</span><span>.</span><span>.</span></span>
                </div>
                <div class="ai-loader-progress"><div class="ai-loader-progress-fill"></div></div>
                <div class="ai-loader-status">
                    <div class="ai-loader-status-inner">
                        <div class="ai-loader-status-item">Analyzing Neural Patterns</div>
                        <div class="ai-loader-status-item">Processing Data Nodes</div>
                        <div class="ai-loader-status-item">Generating Response</div>
                        <div class="ai-loader-status-item">Optimizing Output</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--NEW LOADER-->
    <script>
        var resizefunc = [];

        function toggleExampleQueries() {
            const list = document.getElementById('exampleQueriesList');
            const button = document.getElementById('toggleButton');

            if (list.classList.contains('expanded')) {
                list.classList.remove('expanded');
                button.innerHTML = '<i class="fa fa-chevron-down"></i>';
            } else {
                list.classList.add('expanded');
                button.innerHTML = '<i class="fa fa-chevron-up"></i>';
            }
        }

        function setExampleQuery(queryText) {
            document.getElementById('queryInput').value = queryText;
            // Scroll to query input
            document.getElementById('queryInput').scrollIntoView({ behavior: 'smooth', block: 'center' });
            // Optional: highlight the textarea briefly
            const textarea = document.getElementById('queryInput');
            textarea.style.borderColor = '#ffc107';
            textarea.style.boxShadow = '0 0 10px rgba(255, 193, 7, 0.5)';
            setTimeout(() => {
                textarea.style.borderColor = '#5b69bc';
                textarea.style.boxShadow = 'none';
            }, 1000);
        }
    </script>

    <script>
        // Generate particles - runs once when loaded
        (function () {
            var c = document.getElementById('ai-loader-particles');
            if (!c) return;
            var colors = ['#00f0ff', '#ff00e5', '#8b5cf6', '#00ffaa'];
            for (var i = 0; i < 40; i++) {
                var p = document.createElement('div');
                p.className = 'ai-loader-particle';
                p.style.left = Math.random() * 100 + '%';
                p.style.setProperty('--duration', (6 + Math.random() * 10) + 's');
                p.style.setProperty('--delay', (Math.random() * 8) + 's');
                var s = (1 + Math.random() * 3) + 'px';
                p.style.width = s;
                p.style.height = s;
                p.style.background = colors[Math.floor(Math.random() * colors.length)];
                c.appendChild(p);
            }
        })();
    </script>
    <!-- jQuery  -->
    <script src="assets/js/bootstrap-rtl.min.js"></script>
    <script src="assets/js/detect.js"></script>
    <script src="assets/js/fastclick.js"></script>
    <script src="assets/js/jquery.slimscroll.js"></script>
    <script src="assets/js/jquery.blockUI.js"></script>
    <script src="assets/js/waves.js"></script>
    <script src="assets/js/wow.min.js"></script>
    <script src="assets/js/jquery.nicescroll.js"></script>
    <script src="assets/js/jquery.scrollTo.min.js"></script>
    <script src="../plugins/switchery/switchery.min.js"></script>

    <!-- Sweet Alert js -->
    <script src="../plugins/bootstrap-sweetalert/sweet-alert.min.js"></script>
    <script src="assets/pages/jquery.sweet-alert.init.js"></script>

    <script src="assets/js/jquery.core.js"></script>
    <script src="assets/js/jquery.app.js"></script>


</body>
</html>